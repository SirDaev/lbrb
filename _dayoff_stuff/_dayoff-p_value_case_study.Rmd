---
title: "Data simulation & P-value case study"
author: "Nathan Brouwer"
date: "10/15/2019"
output:
  pdf_document: default
  html_document: default
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## How do we simulate data from a normal distribution?

We'll consider the second to last column, under "Week 12"

What is +/- X mean?
What type of number is after the +/-?  
What is the sample size?

```{r}
# Week 12 data
n <- 28
my.mean <- 14.76
my.sd   <- 10.29

my.data <- rnorm(n = n, mean = my.mean, sd = my.sd)
```



## Check out simulated data

```{r}
mean(my.data)
sd(my.data)
```


## What is a range of plausible values?

```{r}
my.min <- 0
my.max <- 8*my.sd
```

## Make sequence of plausible values

```{r}
my.seq <- seq(from = my.min, to = my.max, by = 0.1)
```

```{r}
min(my.seq)
max(my.seq)
range(my.seq)
```


## Draw the "Density function" of the normal curve for you range

```{r}
my.normal.curve <- dnorm(x = my.seq, mean = my.mean, sd = my.sd)
```


## Plot the density function

```{r}
plot(my.normal.curve ~ my.seq, type = "l")
abline(v = my.mean)
abline(v = my.mean - my.sd)
abline(v = my.mean + my.sd)
```



## Plot simulated ata

```{r}
hist(my.data)
abline(v = my.mean, col= 2)
abline(v = 0, col = 3)
```


## How can I make valid data?

## Workable data

% Fast Progressive in Lactolycopene "arm" (treatment group)

```{r}
baseline <- c(2.165751, 18.595921,17.158801, 5.626549,1.907980,14.834630,1.568601,6.341502,18.489389,7.322593,9.938555,2.806024, 9.029434,29.948006, 2.247686,1.58033, 19.597228, 22.094942,  5.713589, 16.128858,  8.063147,  4.301943,  5.228189, 10.151284, 14.225289,  1.647791, 33.016771,  9.826562)


wk.12 <-c(18.375663,  29.441635,   6.886321,   8.832303,  33.199704,  4.642406,  5.507830, 31.062378, 24.982074, 10.936893, 12.973502,  3.417660, 22.097952, 41.831826, 29.514890, 31.862180,  7.920042,  5.168505, 20.554914, 18.899862, 16.361024, 63.875732, 42.017015, 35.062467,  5.957915,  1.759863, 11.808719, 43.414362)
```

```{r}
mean(baseline)
sd(baseline)

mean(wk.12)
sd(wk.12)
```


Difference between treatments

```{r}
difference <- wk.12 - baseline
```

```{r}
mean(difference)
sd(difference)

```

Is the mean difference "significantly different from 0.0?

That is, are most differences near zero? Or are there as many increases as decreases?

That is, if in reality there was no effect of lycopene, how unusual would be my results?

```{r}
t.test(difference)
```


Simulate a null results

```{r}
null.results <- rnorm(n = n, mean = 0, sd = 10)
```

```{r}
hist(null.results)
```


```{r}
t.test(null.results)
```


