<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 40 UPGMA the hard way | A Little Book of R for Bioinformatics 2.0</title>
  <meta name="description" content="An entry-level text for bioinformatics and computational biology" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 40 UPGMA the hard way | A Little Book of R for Bioinformatics 2.0" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An entry-level text for bioinformatics and computational biology" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 40 UPGMA the hard way | A Little Book of R for Bioinformatics 2.0" />
  
  <meta name="twitter:description" content="An entry-level text for bioinformatics and computational biology" />
  

<meta name="author" content="Avirl Coghlan, with contributions by Nathan L. Brouwer" />


<meta name="date" content="2021-07-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"/>
<link rel="next" href="representing-phylogenetic-trees-in-newick-format.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Little Book of R for Bioinformatics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface to version 2.0</a></li>
<li class="chapter" data-level="1" data-path="how-to-review-this-book.html"><a href="how-to-review-this-book.html"><i class="fa fa-check"></i><b>1</b> How to review this book</a>
<ul>
<li class="chapter" data-level="1.1" data-path="how-to-review-this-book.html"><a href="how-to-review-this-book.html#file-format"><i class="fa fa-check"></i><b>1.1</b> File format</a></li>
<li class="chapter" data-level="1.2" data-path="how-to-review-this-book.html"><a href="how-to-review-this-book.html#what-can-you-do"><i class="fa fa-check"></i><b>1.2</b> What can you do?</a></li>
<li class="chapter" data-level="1.3" data-path="how-to-review-this-book.html"><a href="how-to-review-this-book.html#adding-comments"><i class="fa fa-check"></i><b>1.3</b> Adding comments</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="how-to-review-this-book.html"><a href="how-to-review-this-book.html#html-tagged-comments"><i class="fa fa-check"></i><b>1.3.1</b> HTML-tagged comments</a></li>
<li class="chapter" data-level="1.3.2" data-path="how-to-review-this-book.html"><a href="how-to-review-this-book.html#code-chunk-comments"><i class="fa fa-check"></i><b>1.3.2</b> Code chunk comments</a></li>
<li class="chapter" data-level="1.3.3" data-path="how-to-review-this-book.html"><a href="how-to-review-this-book.html#keys-to-exercise"><i class="fa fa-check"></i><b>1.3.3</b> Keys to exercise</a></li>
<li class="chapter" data-level="1.3.4" data-path="how-to-review-this-book.html"><a href="how-to-review-this-book.html#problem---fix-this-code"><i class="fa fa-check"></i><b>1.3.4</b> Problem - fix this code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="test-audio-link.html"><a href="test-audio-link.html"><i class="fa fa-check"></i><b>2</b> Test audio link</a></li>
<li class="chapter" data-level="3" data-path="test-shiny-app.html"><a href="test-shiny-app.html"><i class="fa fa-check"></i><b>3</b> Test shiny app</a></li>
<li class="chapter" data-level="4" data-path="test-youtube-vidoe.html"><a href="test-youtube-vidoe.html"><i class="fa fa-check"></i><b>4</b> Test YouTube vidoe</a></li>
<li class="chapter" data-level="5" data-path="test-webpage-insertion.html"><a href="test-webpage-insertion.html"><i class="fa fa-check"></i><b>5</b> Test webpage insertion</a></li>
<li class="chapter" data-level="6" data-path="datacamp-test.html"><a href="datacamp-test.html"><i class="fa fa-check"></i><b>6</b> Datacamp test</a></li>
<li class="chapter" data-level="7" data-path="downloading-r.html"><a href="downloading-r.html"><i class="fa fa-check"></i><b>7</b> Downloading R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="downloading-r.html"><a href="downloading-r.html#preface"><i class="fa fa-check"></i><b>7.1</b> Preface</a></li>
<li class="chapter" data-level="7.2" data-path="downloading-r.html"><a href="downloading-r.html#introduction-to-r"><i class="fa fa-check"></i><b>7.2</b> Introduction to R</a></li>
<li class="chapter" data-level="7.3" data-path="downloading-r.html"><a href="downloading-r.html#installing-r"><i class="fa fa-check"></i><b>7.3</b> Installing R</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="downloading-r.html"><a href="downloading-r.html#installing-r-on-a-windows-pc"><i class="fa fa-check"></i><b>7.3.1</b> Installing <em>R</em> on a Windows PC</a></li>
<li class="chapter" data-level="7.3.2" data-path="downloading-r.html"><a href="downloading-r.html#how-to-install-r-on-non-windows-computers-eg.-macintosh-or-linux-computers"><i class="fa fa-check"></i><b>7.3.2</b> How to install <em>R</em> on non-Windows computers (eg. Macintosh or Linux computers)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="downloading-r.html"><a href="downloading-r.html#starting-r"><i class="fa fa-check"></i><b>7.4</b> Starting <em>R</em></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="installing-the-rstudio-ide.html"><a href="installing-the-rstudio-ide.html"><i class="fa fa-check"></i><b>8</b> Installing the RStudio IDE</a>
<ul>
<li class="chapter" data-level="8.1" data-path="installing-the-rstudio-ide.html"><a href="installing-the-rstudio-ide.html#getting-to-know-rstudio"><i class="fa fa-check"></i><b>8.1</b> Getting to know RStudio</a></li>
<li class="chapter" data-level="8.2" data-path="installing-the-rstudio-ide.html"><a href="installing-the-rstudio-ide.html#rstudio-versus-rstudio-cloud"><i class="fa fa-check"></i><b>8.2</b> RStudio versus RStudio Cloud</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="installing-r-packages.html"><a href="installing-r-packages.html"><i class="fa fa-check"></i><b>9</b> Installing <em>R</em> packages</a>
<ul>
<li class="chapter" data-level="9.1" data-path="installing-r-packages.html"><a href="installing-r-packages.html#downloading-packages-with-the-rstudio-ide"><i class="fa fa-check"></i><b>9.1</b> Downloading packages with the RStudio IDE</a></li>
<li class="chapter" data-level="9.2" data-path="installing-r-packages.html"><a href="installing-r-packages.html#downloading-packages-with-the-function-install.packages"><i class="fa fa-check"></i><b>9.2</b> Downloading packages with the function <code>install.packages()</code></a></li>
<li class="chapter" data-level="9.3" data-path="installing-r-packages.html"><a href="installing-r-packages.html#using-packages-after-they-are-downloaded"><i class="fa fa-check"></i><b>9.3</b> Using packages after they are downloaded</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="installing-bioconductor.html"><a href="installing-bioconductor.html"><i class="fa fa-check"></i><b>10</b> Installing Bioconductor</a>
<ul>
<li class="chapter" data-level="10.1" data-path="installing-bioconductor.html"><a href="installing-bioconductor.html#bioconductor"><i class="fa fa-check"></i><b>10.1</b> Bioconductor</a></li>
<li class="chapter" data-level="10.2" data-path="installing-bioconductor.html"><a href="installing-bioconductor.html#installing-biocmanager"><i class="fa fa-check"></i><b>10.2</b> Installing BiocManager</a></li>
<li class="chapter" data-level="10.3" data-path="installing-bioconductor.html"><a href="installing-bioconductor.html#the-ins-and-outs-of-package-installation"><i class="fa fa-check"></i><b>10.3</b> The ins and outs of package installation</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="installing-bioconductor.html"><a href="installing-bioconductor.html#updating-other-packages-when-downloading-a-package"><i class="fa fa-check"></i><b>10.3.1</b> Updating other packages when downloading a package</a></li>
<li class="chapter" data-level="10.3.2" data-path="installing-bioconductor.html"><a href="installing-bioconductor.html#packages-from-source"><i class="fa fa-check"></i><b>10.3.2</b> Packages “from source”</a></li>
<li class="chapter" data-level="10.3.3" data-path="installing-bioconductor.html"><a href="installing-bioconductor.html#more-on-angry-red-text"><i class="fa fa-check"></i><b>10.3.3</b> More on angry red text</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="installing-bioconductor.html"><a href="installing-bioconductor.html#actually-loading-a-package"><i class="fa fa-check"></i><b>10.4</b> Actually loading a package</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html"><i class="fa fa-check"></i><b>11</b> A Brief introduction to R</a>
<ul>
<li class="chapter" data-level="11.1" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html#vocabulary"><i class="fa fa-check"></i><b>11.1</b> Vocabulary</a></li>
<li class="chapter" data-level="11.2" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html#r-functions"><i class="fa fa-check"></i><b>11.2</b> R functions</a></li>
<li class="chapter" data-level="11.3" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html#interacting-with-r"><i class="fa fa-check"></i><b>11.3</b> Interacting with R</a></li>
<li class="chapter" data-level="11.4" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html#variables-in-r"><i class="fa fa-check"></i><b>11.4</b> Variables in R</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html#vectors"><i class="fa fa-check"></i><b>11.4.1</b> Vectors</a></li>
<li class="chapter" data-level="11.4.2" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html#vector-indexing"><i class="fa fa-check"></i><b>11.4.2</b> Vector indexing</a></li>
<li class="chapter" data-level="11.4.3" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html#character-vectors"><i class="fa fa-check"></i><b>11.4.3</b> Character vectors</a></li>
<li class="chapter" data-level="11.4.4" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html#lists"><i class="fa fa-check"></i><b>11.4.4</b> Lists</a></li>
<li class="chapter" data-level="11.4.5" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html#tables"><i class="fa fa-check"></i><b>11.4.5</b> Tables</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html#arguments"><i class="fa fa-check"></i><b>11.5</b> Arguments</a></li>
<li class="chapter" data-level="11.6" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html#help-files-with-help-and"><i class="fa fa-check"></i><b>11.6</b> Help files with <code>help()</code> and <code>?</code></a></li>
<li class="chapter" data-level="11.7" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html#searching-for-functions-with-help.search-and-rsitesearch"><i class="fa fa-check"></i><b>11.7</b> Searching for functions with <code>help.search()</code> and <code>RSiteSearch()</code></a></li>
<li class="chapter" data-level="11.8" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html#more-on-functions"><i class="fa fa-check"></i><b>11.8</b> More on functions</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html#writing-your-own-functions"><i class="fa fa-check"></i><b>11.8.1</b> Writing your own functions</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html#quiting-r"><i class="fa fa-check"></i><b>11.9</b> Quiting R</a></li>
<li class="chapter" data-level="11.10" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html#links-and-further-reading"><i class="fa fa-check"></i><b>11.10</b> Links and Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="dna-descriptive-statics-part-1.html"><a href="dna-descriptive-statics-part-1.html"><i class="fa fa-check"></i><b>12</b> DNA descriptive statics - Part 1</a>
<ul>
<li class="chapter" data-level="12.1" data-path="dna-descriptive-statics-part-1.html"><a href="dna-descriptive-statics-part-1.html#preface-1"><i class="fa fa-check"></i><b>12.1</b> Preface</a></li>
<li class="chapter" data-level="12.2" data-path="dna-descriptive-statics-part-1.html"><a href="dna-descriptive-statics-part-1.html#writing-todo"><i class="fa fa-check"></i><b>12.2</b> Writing TODO:</a></li>
<li class="chapter" data-level="12.3" data-path="dna-descriptive-statics-part-1.html"><a href="dna-descriptive-statics-part-1.html#introduction"><i class="fa fa-check"></i><b>12.3</b> Introduction</a></li>
<li class="chapter" data-level="12.4" data-path="dna-descriptive-statics-part-1.html"><a href="dna-descriptive-statics-part-1.html#vocabulary-1"><i class="fa fa-check"></i><b>12.4</b> Vocabulary</a></li>
<li class="chapter" data-level="12.5" data-path="dna-descriptive-statics-part-1.html"><a href="dna-descriptive-statics-part-1.html#functions"><i class="fa fa-check"></i><b>12.5</b> Functions</a></li>
<li class="chapter" data-level="12.6" data-path="dna-descriptive-statics-part-1.html"><a href="dna-descriptive-statics-part-1.html#preliminaries"><i class="fa fa-check"></i><b>12.6</b> Preliminaries</a></li>
<li class="chapter" data-level="12.7" data-path="dna-descriptive-statics-part-1.html"><a href="dna-descriptive-statics-part-1.html#converting-dna-from-fasta-format"><i class="fa fa-check"></i><b>12.7</b> Converting DNA from FASTA format</a></li>
<li class="chapter" data-level="12.8" data-path="dna-descriptive-statics-part-1.html"><a href="dna-descriptive-statics-part-1.html#length-of-a-dna-sequence"><i class="fa fa-check"></i><b>12.8</b> Length of a DNA sequence</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="dna-descriptive-statics-part-1.html"><a href="dna-descriptive-statics-part-1.html#base-composition-of-a-dna-sequence"><i class="fa fa-check"></i><b>12.8.1</b> Base composition of a DNA sequence</a></li>
<li class="chapter" data-level="12.8.2" data-path="dna-descriptive-statics-part-1.html"><a href="dna-descriptive-statics-part-1.html#gc-content-of-dna"><i class="fa fa-check"></i><b>12.8.2</b> GC Content of DNA</a></li>
<li class="chapter" data-level="12.8.3" data-path="dna-descriptive-statics-part-1.html"><a href="dna-descriptive-statics-part-1.html#dna-words"><i class="fa fa-check"></i><b>12.8.3</b> DNA words</a></li>
<li class="chapter" data-level="12.8.4" data-path="dna-descriptive-statics-part-1.html"><a href="dna-descriptive-statics-part-1.html#summary"><i class="fa fa-check"></i><b>12.8.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="dna-descriptive-statics-part-1.html"><a href="dna-descriptive-statics-part-1.html#acknowledgements"><i class="fa fa-check"></i><b>12.9</b> Acknowledgements</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="dna-descriptive-statics-part-1.html"><a href="dna-descriptive-statics-part-1.html#license"><i class="fa fa-check"></i><b>12.9.1</b> License</a></li>
<li class="chapter" data-level="12.9.2" data-path="dna-descriptive-statics-part-1.html"><a href="dna-descriptive-statics-part-1.html#exercises"><i class="fa fa-check"></i><b>12.9.2</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="programming-in-r-for-loops.html"><a href="programming-in-r-for-loops.html"><i class="fa fa-check"></i><b>13</b> Programming in R: for loops</a>
<ul>
<li class="chapter" data-level="13.1" data-path="programming-in-r-for-loops.html"><a href="programming-in-r-for-loops.html#preface-2"><i class="fa fa-check"></i><b>13.1</b> Preface</a></li>
<li class="chapter" data-level="13.2" data-path="programming-in-r-for-loops.html"><a href="programming-in-r-for-loops.html#vocab"><i class="fa fa-check"></i><b>13.2</b> Vocab</a></li>
<li class="chapter" data-level="13.3" data-path="programming-in-r-for-loops.html"><a href="programming-in-r-for-loops.html#functions-1"><i class="fa fa-check"></i><b>13.3</b> Functions</a></li>
<li class="chapter" data-level="13.4" data-path="programming-in-r-for-loops.html"><a href="programming-in-r-for-loops.html#basic-for-loops-in-in-r"><i class="fa fa-check"></i><b>13.4</b> Basic for loops in in R</a></li>
<li class="chapter" data-level="13.5" data-path="programming-in-r-for-loops.html"><a href="programming-in-r-for-loops.html#challenge-complicated-vectors-of-values"><i class="fa fa-check"></i><b>13.5</b> Challenge: complicated vectors of values</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="mini-tutorial-vectors-in-r.html"><a href="mini-tutorial-vectors-in-r.html"><i class="fa fa-check"></i><b>14</b> Mini tutorial: Vectors in R</a>
<ul>
<li class="chapter" data-level="14.1" data-path="mini-tutorial-vectors-in-r.html"><a href="mini-tutorial-vectors-in-r.html#preface-3"><i class="fa fa-check"></i><b>14.1</b> Preface</a></li>
<li class="chapter" data-level="14.2" data-path="mini-tutorial-vectors-in-r.html"><a href="mini-tutorial-vectors-in-r.html#vocab-1"><i class="fa fa-check"></i><b>14.2</b> Vocab</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="functions-2.html"><a href="functions-2.html"><i class="fa fa-check"></i><b>15</b> Functions</a>
<ul>
<li class="chapter" data-level="15.1" data-path="functions-2.html"><a href="functions-2.html#vectors-in-r"><i class="fa fa-check"></i><b>15.1</b> Vectors in R</a></li>
<li class="chapter" data-level="15.2" data-path="functions-2.html"><a href="functions-2.html#math-on-vectors"><i class="fa fa-check"></i><b>15.2</b> Math on vectors</a></li>
<li class="chapter" data-level="15.3" data-path="functions-2.html"><a href="functions-2.html#functions-on-vectors"><i class="fa fa-check"></i><b>15.3</b> Functions on vectors</a></li>
<li class="chapter" data-level="15.4" data-path="functions-2.html"><a href="functions-2.html#operations-with-two-vectors"><i class="fa fa-check"></i><b>15.4</b> Operations with two vectors</a></li>
<li class="chapter" data-level="15.5" data-path="functions-2.html"><a href="functions-2.html#subsetting-vectors"><i class="fa fa-check"></i><b>15.5</b> Subsetting vectors</a></li>
<li class="chapter" data-level="15.6" data-path="functions-2.html"><a href="functions-2.html#sequences-of-numbers"><i class="fa fa-check"></i><b>15.6</b> Sequences of numbers</a></li>
<li class="chapter" data-level="15.7" data-path="functions-2.html"><a href="functions-2.html#vectors-can-hold-numeric-or-character-data"><i class="fa fa-check"></i><b>15.7</b> Vectors can hold numeric or character data</a></li>
<li class="chapter" data-level="15.8" data-path="functions-2.html"><a href="functions-2.html#regular-expressions-can-modify-character-data"><i class="fa fa-check"></i><b>15.8</b> Regular expressions can modify character data</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="plotting-vectors-in-base-r.html"><a href="plotting-vectors-in-base-r.html"><i class="fa fa-check"></i><b>16</b> Plotting vectors in base R</a>
<ul>
<li class="chapter" data-level="16.1" data-path="plotting-vectors-in-base-r.html"><a href="plotting-vectors-in-base-r.html#preface-4"><i class="fa fa-check"></i><b>16.1</b> Preface</a></li>
<li class="chapter" data-level="16.2" data-path="plotting-vectors-in-base-r.html"><a href="plotting-vectors-in-base-r.html#plotting-numeric-data"><i class="fa fa-check"></i><b>16.2</b> Plotting numeric data</a></li>
<li class="chapter" data-level="16.3" data-path="plotting-vectors-in-base-r.html"><a href="plotting-vectors-in-base-r.html#other-plotting-packages"><i class="fa fa-check"></i><b>16.3</b> Other plotting packages</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="programming-in-r-functions.html"><a href="programming-in-r-functions.html"><i class="fa fa-check"></i><b>17</b> Programming in R: functions</a>
<ul>
<li class="chapter" data-level="17.1" data-path="programming-in-r-functions.html"><a href="programming-in-r-functions.html#preface-5"><i class="fa fa-check"></i><b>17.1</b> Preface</a></li>
<li class="chapter" data-level="17.2" data-path="programming-in-r-functions.html"><a href="programming-in-r-functions.html#vocab-2"><i class="fa fa-check"></i><b>17.2</b> Vocab</a></li>
<li class="chapter" data-level="17.3" data-path="programming-in-r-functions.html"><a href="programming-in-r-functions.html#functions-3"><i class="fa fa-check"></i><b>17.3</b> Functions</a></li>
<li class="chapter" data-level="17.4" data-path="programming-in-r-functions.html"><a href="programming-in-r-functions.html#functions-in-r"><i class="fa fa-check"></i><b>17.4</b> Functions in R</a></li>
<li class="chapter" data-level="17.5" data-path="programming-in-r-functions.html"><a href="programming-in-r-functions.html#comments-in-r"><i class="fa fa-check"></i><b>17.5</b> Comments in R</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="fasta-files.html"><a href="fasta-files.html"><i class="fa fa-check"></i><b>18</b> FASTA Files</a>
<ul>
<li class="chapter" data-level="18.1" data-path="fasta-files.html"><a href="fasta-files.html#example-fasta-file"><i class="fa fa-check"></i><b>18.1</b> Example FASTA file</a></li>
<li class="chapter" data-level="18.2" data-path="fasta-files.html"><a href="fasta-files.html#multiple-sequences-in-a-single-fasta-file"><i class="fa fa-check"></i><b>18.2</b> Multiple sequences in a single FASTA file</a></li>
<li class="chapter" data-level="18.3" data-path="fasta-files.html"><a href="fasta-files.html#multiple-sequence-alignments-can-be-stored-in-fasta-format"><i class="fa fa-check"></i><b>18.3</b> Multiple sequence alignments can be stored in FASTA format</a></li>
<li class="chapter" data-level="18.4" data-path="fasta-files.html"><a href="fasta-files.html#fastq-format"><i class="fa fa-check"></i><b>18.4</b> FASTQ Format</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="downloading-dna-sequences-as-fasta-files-in-r.html"><a href="downloading-dna-sequences-as-fasta-files-in-r.html"><i class="fa fa-check"></i><b>19</b> Downloading DNA sequences as FASTA files in R</a>
<ul>
<li class="chapter" data-level="19.0.1" data-path="downloading-dna-sequences-as-fasta-files-in-r.html"><a href="downloading-dna-sequences-as-fasta-files-in-r.html#functions-4"><i class="fa fa-check"></i><b>19.0.1</b> Functions</a></li>
<li class="chapter" data-level="19.0.2" data-path="downloading-dna-sequences-as-fasta-files-in-r.html"><a href="downloading-dna-sequences-as-fasta-files-in-r.html#softwarewebsites"><i class="fa fa-check"></i><b>19.0.2</b> Software/websites</a></li>
<li class="chapter" data-level="19.0.3" data-path="downloading-dna-sequences-as-fasta-files-in-r.html"><a href="downloading-dna-sequences-as-fasta-files-in-r.html#r-vocabulary"><i class="fa fa-check"></i><b>19.0.3</b> R vocabulary</a></li>
<li class="chapter" data-level="19.0.4" data-path="downloading-dna-sequences-as-fasta-files-in-r.html"><a href="downloading-dna-sequences-as-fasta-files-in-r.html#file-types"><i class="fa fa-check"></i><b>19.0.4</b> File types</a></li>
<li class="chapter" data-level="19.0.5" data-path="downloading-dna-sequences-as-fasta-files-in-r.html"><a href="downloading-dna-sequences-as-fasta-files-in-r.html#bioinformatics-vocabulary"><i class="fa fa-check"></i><b>19.0.5</b> Bioinformatics vocabulary</a></li>
<li class="chapter" data-level="19.0.6" data-path="downloading-dna-sequences-as-fasta-files-in-r.html"><a href="downloading-dna-sequences-as-fasta-files-in-r.html#organisms-and-sequence-accessions"><i class="fa fa-check"></i><b>19.0.6</b> Organisms and Sequence accessions</a></li>
<li class="chapter" data-level="19.0.7" data-path="downloading-dna-sequences-as-fasta-files-in-r.html"><a href="downloading-dna-sequences-as-fasta-files-in-r.html#preliminaries-1"><i class="fa fa-check"></i><b>19.0.7</b> Preliminaries</a></li>
<li class="chapter" data-level="19.1" data-path="downloading-dna-sequences-as-fasta-files-in-r.html"><a href="downloading-dna-sequences-as-fasta-files-in-r.html#dna-sequence-statistics-part-1"><i class="fa fa-check"></i><b>19.1</b> DNA Sequence Statistics: Part 1</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="downloading-dna-sequences-as-fasta-files-in-r.html"><a href="downloading-dna-sequences-as-fasta-files-in-r.html#using-r-for-bioinformatics"><i class="fa fa-check"></i><b>19.1.1</b> Using R for Bioinformatics</a></li>
<li class="chapter" data-level="19.1.2" data-path="downloading-dna-sequences-as-fasta-files-in-r.html"><a href="downloading-dna-sequences-as-fasta-files-in-r.html#r-packages-for-bioinformatics-bioconductor-and-seqinr"><i class="fa fa-check"></i><b>19.1.2</b> R packages for bioinformatics: Bioconductor and SeqinR</a></li>
<li class="chapter" data-level="19.1.3" data-path="downloading-dna-sequences-as-fasta-files-in-r.html"><a href="downloading-dna-sequences-as-fasta-files-in-r.html#fasta-file-format"><i class="fa fa-check"></i><b>19.1.3</b> FASTA file format</a></li>
<li class="chapter" data-level="19.1.4" data-path="downloading-dna-sequences-as-fasta-files-in-r.html"><a href="downloading-dna-sequences-as-fasta-files-in-r.html#the-ncbi-sequence-database"><i class="fa fa-check"></i><b>19.1.4</b> The NCBI sequence database</a></li>
<li class="chapter" data-level="19.1.5" data-path="downloading-dna-sequences-as-fasta-files-in-r.html"><a href="downloading-dna-sequences-as-fasta-files-in-r.html#retrieving-genome-sequence-data-using-rentrez"><i class="fa fa-check"></i><b>19.1.5</b> Retrieving genome sequence data using rentrez</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="downloading-dna-sequences-as-fasta-files-in-r.html"><a href="downloading-dna-sequences-as-fasta-files-in-r.html#optional-saving-fasta-files"><i class="fa fa-check"></i><b>19.2</b> OPTIONAL: Saving FASTA files</a></li>
<li class="chapter" data-level="19.3" data-path="downloading-dna-sequences-as-fasta-files-in-r.html"><a href="downloading-dna-sequences-as-fasta-files-in-r.html#next-steps"><i class="fa fa-check"></i><b>19.3</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="downloading-dna-sequences-as-fasta-files-in-r-1.html"><a href="downloading-dna-sequences-as-fasta-files-in-r-1.html"><i class="fa fa-check"></i><b>20</b> Downloading DNA sequences as FASTA files in R</a>
<ul>
<li class="chapter" data-level="20.1" data-path="downloading-dna-sequences-as-fasta-files-in-r-1.html"><a href="downloading-dna-sequences-as-fasta-files-in-r-1.html#preliminaries-2"><i class="fa fa-check"></i><b>20.1</b> Preliminaries</a></li>
<li class="chapter" data-level="20.2" data-path="downloading-dna-sequences-as-fasta-files-in-r-1.html"><a href="downloading-dna-sequences-as-fasta-files-in-r-1.html#convert-fasta-sequence-to-an-r-variable"><i class="fa fa-check"></i><b>20.2</b> Convert FASTA sequence to an R variable</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="downloading-dna-sequences-as-fasta-files-in-r-1.html"><a href="downloading-dna-sequences-as-fasta-files-in-r-1.html#removing-unwanted-characters"><i class="fa fa-check"></i><b>20.2.1</b> Removing unwanted characters</a></li>
<li class="chapter" data-level="20.2.2" data-path="downloading-dna-sequences-as-fasta-files-in-r-1.html"><a href="downloading-dna-sequences-as-fasta-files-in-r-1.html#spliting-unbroken-strings-in-character-vectors"><i class="fa fa-check"></i><b>20.2.2</b> Spliting unbroken strings in character vectors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="downloading-protein-sequences-in-r.html"><a href="downloading-protein-sequences-in-r.html"><i class="fa fa-check"></i><b>21</b> Downloading protein sequences in <em>R</em></a>
<ul>
<li class="chapter" data-level="21.1" data-path="downloading-protein-sequences-in-r.html"><a href="downloading-protein-sequences-in-r.html#preliminaries-3"><i class="fa fa-check"></i><b>21.1</b> Preliminaries</a></li>
<li class="chapter" data-level="21.2" data-path="downloading-protein-sequences-in-r.html"><a href="downloading-protein-sequences-in-r.html#retrieving-a-uniprot-protein-sequence-using-rentrez"><i class="fa fa-check"></i><b>21.2</b> Retrieving a UniProt protein sequence using rentrez</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="sequence-dotplots-in-r.html"><a href="sequence-dotplots-in-r.html"><i class="fa fa-check"></i><b>22</b> Sequence dotplots in <em>R</em></a>
<ul>
<li class="chapter" data-level="22.1" data-path="sequence-dotplots-in-r.html"><a href="sequence-dotplots-in-r.html#preliminaries-4"><i class="fa fa-check"></i><b>22.1</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="sequence-dotplots-in-r.html"><a href="sequence-dotplots-in-r.html#download-sequences"><i class="fa fa-check"></i><b>22.1.1</b> Download sequences</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="sequence-dotplots-in-r.html"><a href="sequence-dotplots-in-r.html#visualzing-two-identical-sequences"><i class="fa fa-check"></i><b>22.2</b> Visualzing two identical sequences</a></li>
<li class="chapter" data-level="22.3" data-path="sequence-dotplots-in-r.html"><a href="sequence-dotplots-in-r.html#visualizing-repeats"><i class="fa fa-check"></i><b>22.3</b> Visualizing repeats</a></li>
<li class="chapter" data-level="22.4" data-path="sequence-dotplots-in-r.html"><a href="sequence-dotplots-in-r.html#inversions"><i class="fa fa-check"></i><b>22.4</b> Inversions</a></li>
<li class="chapter" data-level="22.5" data-path="sequence-dotplots-in-r.html"><a href="sequence-dotplots-in-r.html#translocations"><i class="fa fa-check"></i><b>22.5</b> Translocations</a></li>
<li class="chapter" data-level="22.6" data-path="sequence-dotplots-in-r.html"><a href="sequence-dotplots-in-r.html#random-sequence"><i class="fa fa-check"></i><b>22.6</b> Random sequence</a></li>
<li class="chapter" data-level="22.7" data-path="sequence-dotplots-in-r.html"><a href="sequence-dotplots-in-r.html#comparing-two-real-sequences-using-a-dotplot"><i class="fa fa-check"></i><b>22.7</b> Comparing two real sequences using a dotplot</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="global-proteins-aligments-in-r.html"><a href="global-proteins-aligments-in-r.html"><i class="fa fa-check"></i><b>23</b> Global proteins aligments in <em>R</em></a>
<ul>
<li class="chapter" data-level="23.1" data-path="global-proteins-aligments-in-r.html"><a href="global-proteins-aligments-in-r.html#preliminaries-5"><i class="fa fa-check"></i><b>23.1</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="23.1.1" data-path="global-proteins-aligments-in-r.html"><a href="global-proteins-aligments-in-r.html#download-sequences-1"><i class="fa fa-check"></i><b>23.1.1</b> Download sequences</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="global-proteins-aligments-in-r.html"><a href="global-proteins-aligments-in-r.html#pairwise-global-alignment-of-dna-sequences-using-the-needleman-wunsch-algorithm"><i class="fa fa-check"></i><b>23.2</b> Pairwise global alignment of DNA sequences using the Needleman-Wunsch algorithm</a></li>
<li class="chapter" data-level="23.3" data-path="global-proteins-aligments-in-r.html"><a href="global-proteins-aligments-in-r.html#pairwise-global-alignment-of-protein-sequences-using-the-needleman-wunsch-algorithm"><i class="fa fa-check"></i><b>23.3</b> Pairwise global alignment of protein sequences using the Needleman-Wunsch algorithm</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="global-proteins-aligments-in-r.html"><a href="global-proteins-aligments-in-r.html#protein-score-matrices"><i class="fa fa-check"></i><b>23.3.1</b> Protein score matrices</a></li>
<li class="chapter" data-level="23.3.2" data-path="global-proteins-aligments-in-r.html"><a href="global-proteins-aligments-in-r.html#example-protein-alignment"><i class="fa fa-check"></i><b>23.3.2</b> Example protein alignment</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="global-proteins-aligments-in-r.html"><a href="global-proteins-aligments-in-r.html#aligning-uniprot-sequences"><i class="fa fa-check"></i><b>23.4</b> Aligning UniProt sequences</a></li>
<li class="chapter" data-level="23.5" data-path="global-proteins-aligments-in-r.html"><a href="global-proteins-aligments-in-r.html#viewing-a-long-pairwise-alignment"><i class="fa fa-check"></i><b>23.5</b> Viewing a long pairwise alignment</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="local-protein-aligments-in-r.html"><a href="local-protein-aligments-in-r.html"><i class="fa fa-check"></i><b>24</b> Local protein aligments in <em>R</em></a>
<ul>
<li class="chapter" data-level="24.1" data-path="local-protein-aligments-in-r.html"><a href="local-protein-aligments-in-r.html#preliminaries-6"><i class="fa fa-check"></i><b>24.1</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="local-protein-aligments-in-r.html"><a href="local-protein-aligments-in-r.html#download-sequences-2"><i class="fa fa-check"></i><b>24.1.1</b> Download sequences</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="local-protein-aligments-in-r.html"><a href="local-protein-aligments-in-r.html#pairwise-local-alignment-of-protein-sequences-using-the-smith-waterman-algorithm"><i class="fa fa-check"></i><b>24.2</b> Pairwise local alignment of protein sequences using the Smith-Waterman algorithm</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="matrix-vocabulary.html"><a href="matrix-vocabulary.html"><i class="fa fa-check"></i><b>25</b> Matrix vocabulary</a>
<ul>
<li class="chapter" data-level="25.1" data-path="matrix-vocabulary.html"><a href="matrix-vocabulary.html#introduction-1"><i class="fa fa-check"></i><b>25.1</b> Introduction</a></li>
<li class="chapter" data-level="25.2" data-path="matrix-vocabulary.html"><a href="matrix-vocabulary.html#preliminaries-7"><i class="fa fa-check"></i><b>25.2</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="matrix-vocabulary.html"><a href="matrix-vocabulary.html#packages"><i class="fa fa-check"></i><b>25.2.1</b> Packages</a></li>
<li class="chapter" data-level="25.2.2" data-path="matrix-vocabulary.html"><a href="matrix-vocabulary.html#vocab-3"><i class="fa fa-check"></i><b>25.2.2</b> Vocab</a></li>
<li class="chapter" data-level="25.2.3" data-path="matrix-vocabulary.html"><a href="matrix-vocabulary.html#functions-used"><i class="fa fa-check"></i><b>25.2.3</b> Functions used</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="matrix-vocabulary.html"><a href="matrix-vocabulary.html#load-packages"><i class="fa fa-check"></i><b>25.3</b> Load packages</a></li>
<li class="chapter" data-level="25.4" data-path="matrix-vocabulary.html"><a href="matrix-vocabulary.html#matrix-structure"><i class="fa fa-check"></i><b>25.4</b> Matrix structure</a></li>
<li class="chapter" data-level="25.5" data-path="matrix-vocabulary.html"><a href="matrix-vocabulary.html#diagonal-of-a-matrix"><i class="fa fa-check"></i><b>25.5</b> Diagonal of a matrix</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="alignment-in-r.html"><a href="alignment-in-r.html"><i class="fa fa-check"></i><b>26</b> Alignment in R</a>
<ul>
<li class="chapter" data-level="26.1" data-path="alignment-in-r.html"><a href="alignment-in-r.html#preliminaries-8"><i class="fa fa-check"></i><b>26.1</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="alignment-in-r.html"><a href="alignment-in-r.html#packages-1"><i class="fa fa-check"></i><b>26.1.1</b> Packages</a></li>
<li class="chapter" data-level="26.1.2" data-path="alignment-in-r.html"><a href="alignment-in-r.html#data"><i class="fa fa-check"></i><b>26.1.2</b> Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="manipulating-matrices-and-vectors-worked-example.html"><a href="manipulating-matrices-and-vectors-worked-example.html"><i class="fa fa-check"></i><b>27</b> Manipulating matrices and vectors: worked example</a>
<ul>
<li class="chapter" data-level="27.1" data-path="manipulating-matrices-and-vectors-worked-example.html"><a href="manipulating-matrices-and-vectors-worked-example.html#introduction-2"><i class="fa fa-check"></i><b>27.1</b> Introduction</a></li>
<li class="chapter" data-level="27.2" data-path="manipulating-matrices-and-vectors-worked-example.html"><a href="manipulating-matrices-and-vectors-worked-example.html#preliminaries-9"><i class="fa fa-check"></i><b>27.2</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="27.2.1" data-path="manipulating-matrices-and-vectors-worked-example.html"><a href="manipulating-matrices-and-vectors-worked-example.html#packages-2"><i class="fa fa-check"></i><b>27.2.1</b> Packages</a></li>
<li class="chapter" data-level="27.2.2" data-path="manipulating-matrices-and-vectors-worked-example.html"><a href="manipulating-matrices-and-vectors-worked-example.html#vocab-4"><i class="fa fa-check"></i><b>27.2.2</b> Vocab</a></li>
<li class="chapter" data-level="27.2.3" data-path="manipulating-matrices-and-vectors-worked-example.html"><a href="manipulating-matrices-and-vectors-worked-example.html#functions-used-1"><i class="fa fa-check"></i><b>27.2.3</b> Functions used</a></li>
<li class="chapter" data-level="27.2.4" data-path="manipulating-matrices-and-vectors-worked-example.html"><a href="manipulating-matrices-and-vectors-worked-example.html#packages-3"><i class="fa fa-check"></i><b>27.2.4</b> Packages</a></li>
<li class="chapter" data-level="27.2.5" data-path="manipulating-matrices-and-vectors-worked-example.html"><a href="manipulating-matrices-and-vectors-worked-example.html#data-1"><i class="fa fa-check"></i><b>27.2.5</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="manipulating-matrices-and-vectors-worked-example.html"><a href="manipulating-matrices-and-vectors-worked-example.html#matrix-elements-can-be-accessed-with-square-bracket-notation"><i class="fa fa-check"></i><b>27.3</b> Matrix elements can be accessed with square bracket notation</a></li>
<li class="chapter" data-level="27.4" data-path="manipulating-matrices-and-vectors-worked-example.html"><a href="manipulating-matrices-and-vectors-worked-example.html#r-object-names"><i class="fa fa-check"></i><b>27.4</b> R object names</a>
<ul>
<li class="chapter" data-level="27.4.1" data-path="manipulating-matrices-and-vectors-worked-example.html"><a href="manipulating-matrices-and-vectors-worked-example.html#accessing-items-in-names-vectors"><i class="fa fa-check"></i><b>27.4.1</b> Accessing items in names vectors</a></li>
<li class="chapter" data-level="27.4.2" data-path="manipulating-matrices-and-vectors-worked-example.html"><a href="manipulating-matrices-and-vectors-worked-example.html#accessing-items-in-names-matrices"><i class="fa fa-check"></i><b>27.4.2</b> Accessing items in names matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="28" data-path="alignment-by-eye-in-r.html"><a href="alignment-by-eye-in-r.html"><i class="fa fa-check"></i><b>28</b> Alignment by eye in R</a>
<ul>
<li class="chapter" data-level="28.1" data-path="alignment-by-eye-in-r.html"><a href="alignment-by-eye-in-r.html#preliminaries-10"><i class="fa fa-check"></i><b>28.1</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="28.1.1" data-path="alignment-by-eye-in-r.html"><a href="alignment-by-eye-in-r.html#packages-4"><i class="fa fa-check"></i><b>28.1.1</b> Packages</a></li>
<li class="chapter" data-level="28.1.2" data-path="alignment-by-eye-in-r.html"><a href="alignment-by-eye-in-r.html#data-2"><i class="fa fa-check"></i><b>28.1.2</b> Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="retrieving-multiple-sequences-in-r.html"><a href="retrieving-multiple-sequences-in-r.html"><i class="fa fa-check"></i><b>29</b> Retrieving multiple sequences in R</a>
<ul>
<li class="chapter" data-level="29.1" data-path="retrieving-multiple-sequences-in-r.html"><a href="retrieving-multiple-sequences-in-r.html#prelminaries"><i class="fa fa-check"></i><b>29.1</b> Prelminaries</a></li>
<li class="chapter" data-level="29.2" data-path="retrieving-multiple-sequences-in-r.html"><a href="retrieving-multiple-sequences-in-r.html#retrieving-a-set-of-sequences-from-uniprot"><i class="fa fa-check"></i><b>29.2</b> Retrieving a set of sequences from UniProt</a></li>
<li class="chapter" data-level="29.3" data-path="retrieving-multiple-sequences-in-r.html"><a href="retrieving-multiple-sequences-in-r.html#downloading-sequences-in-bulk"><i class="fa fa-check"></i><b>29.3</b> Downloading sequences in bulk</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="multiple-sequence-alignment-in-r.html"><a href="multiple-sequence-alignment-in-r.html"><i class="fa fa-check"></i><b>30</b> Multiple sequence alignment in R</a>
<ul>
<li class="chapter" data-level="30.1" data-path="multiple-sequence-alignment-in-r.html"><a href="multiple-sequence-alignment-in-r.html#preliminaries-11"><i class="fa fa-check"></i><b>30.1</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="30.1.1" data-path="multiple-sequence-alignment-in-r.html"><a href="multiple-sequence-alignment-in-r.html#packages-5"><i class="fa fa-check"></i><b>30.1.1</b> Packages</a></li>
<li class="chapter" data-level="30.1.2" data-path="multiple-sequence-alignment-in-r.html"><a href="multiple-sequence-alignment-in-r.html#functions-5"><i class="fa fa-check"></i><b>30.1.2</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="multiple-sequence-alignment-in-r.html"><a href="multiple-sequence-alignment-in-r.html#multiple-sequence-alignment-msa"><i class="fa fa-check"></i><b>30.2</b> Multiple sequence alignment (MSA)</a></li>
<li class="chapter" data-level="30.3" data-path="multiple-sequence-alignment-in-r.html"><a href="multiple-sequence-alignment-in-r.html#make-msa-with-msa"><i class="fa fa-check"></i><b>30.3</b> Make MSA with msa()</a>
<ul>
<li class="chapter" data-level="30.3.1" data-path="multiple-sequence-alignment-in-r.html"><a href="multiple-sequence-alignment-in-r.html#data-preparation"><i class="fa fa-check"></i><b>30.3.1</b> Data preparation</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="multiple-sequence-alignment-in-r.html"><a href="multiple-sequence-alignment-in-r.html#viewing-your-msa"><i class="fa fa-check"></i><b>30.4</b> Viewing your MSA</a>
<ul>
<li class="chapter" data-level="30.4.1" data-path="multiple-sequence-alignment-in-r.html"><a href="multiple-sequence-alignment-in-r.html#viewing-a-long-multiple-alignment-in-the-r-console."><i class="fa fa-check"></i><b>30.4.1</b> Viewing a long multiple alignment in the R console.</a></li>
<li class="chapter" data-level="30.4.2" data-path="multiple-sequence-alignment-in-r.html"><a href="multiple-sequence-alignment-in-r.html#visualizing-alignments-as-an-r-plot"><i class="fa fa-check"></i><b>30.4.2</b> Visualizing alignments as an R plot</a></li>
<li class="chapter" data-level="30.4.3" data-path="multiple-sequence-alignment-in-r.html"><a href="multiple-sequence-alignment-in-r.html#optional-print-msa-to-pdf"><i class="fa fa-check"></i><b>30.4.3</b> OPTIONAL: Print MSA to PDF</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="multiple-sequence-alignment-in-r.html"><a href="multiple-sequence-alignment-in-r.html#discarding-very-poorly-conserved-regions-from-an-alignment"><i class="fa fa-check"></i><b>30.5</b> Discarding very poorly conserved regions from an alignment</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="the-blosum-scoring-matrix-in-r.html"><a href="the-blosum-scoring-matrix-in-r.html"><i class="fa fa-check"></i><b>31</b> The BLOSUM scoring matrix in R</a>
<ul>
<li class="chapter" data-level="31.1" data-path="the-blosum-scoring-matrix-in-r.html"><a href="the-blosum-scoring-matrix-in-r.html#introduction-3"><i class="fa fa-check"></i><b>31.1</b> Introduction</a></li>
<li class="chapter" data-level="31.2" data-path="the-blosum-scoring-matrix-in-r.html"><a href="the-blosum-scoring-matrix-in-r.html#preliminaries-12"><i class="fa fa-check"></i><b>31.2</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="31.2.1" data-path="the-blosum-scoring-matrix-in-r.html"><a href="the-blosum-scoring-matrix-in-r.html#packages-6"><i class="fa fa-check"></i><b>31.2.1</b> Packages</a></li>
<li class="chapter" data-level="31.2.2" data-path="the-blosum-scoring-matrix-in-r.html"><a href="the-blosum-scoring-matrix-in-r.html#vocab-5"><i class="fa fa-check"></i><b>31.2.2</b> Vocab</a></li>
<li class="chapter" data-level="31.2.3" data-path="the-blosum-scoring-matrix-in-r.html"><a href="the-blosum-scoring-matrix-in-r.html#functions-used-2"><i class="fa fa-check"></i><b>31.2.3</b> Functions used</a></li>
</ul></li>
<li class="chapter" data-level="31.3" data-path="the-blosum-scoring-matrix-in-r.html"><a href="the-blosum-scoring-matrix-in-r.html#load-packages-1"><i class="fa fa-check"></i><b>31.3</b> Load packages</a></li>
<li class="chapter" data-level="31.4" data-path="the-blosum-scoring-matrix-in-r.html"><a href="the-blosum-scoring-matrix-in-r.html#the-blosum-matrix"><i class="fa fa-check"></i><b>31.4</b> The BLOSUM matrix</a></li>
<li class="chapter" data-level="31.5" data-path="the-blosum-scoring-matrix-in-r.html"><a href="the-blosum-scoring-matrix-in-r.html#visualizing-the-blosum-matrix"><i class="fa fa-check"></i><b>31.5</b> Visualizing the BLOSUM matrix</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="calculating-genetic-distances-between-sequences.html"><a href="calculating-genetic-distances-between-sequences.html"><i class="fa fa-check"></i><b>32</b> Calculating genetic distances between sequences</a>
<ul>
<li class="chapter" data-level="32.1" data-path="calculating-genetic-distances-between-sequences.html"><a href="calculating-genetic-distances-between-sequences.html#preliminaries-13"><i class="fa fa-check"></i><b>32.1</b> Preliminaries</a></li>
<li class="chapter" data-level="32.2" data-path="calculating-genetic-distances-between-sequences.html"><a href="calculating-genetic-distances-between-sequences.html#introduction-4"><i class="fa fa-check"></i><b>32.2</b> Introduction</a></li>
<li class="chapter" data-level="32.3" data-path="calculating-genetic-distances-between-sequences.html"><a href="calculating-genetic-distances-between-sequences.html#calculating-genetic-distances-between-dnamrna-sequences"><i class="fa fa-check"></i><b>32.3</b> Calculating genetic distances between DNA/mRNA sequences</a></li>
<li class="chapter" data-level="32.4" data-path="calculating-genetic-distances-between-sequences.html"><a href="calculating-genetic-distances-between-sequences.html#calculationg-genetic-distance"><i class="fa fa-check"></i><b>32.4</b> Calculationg genetic distance</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="unrooted-neighbor-joining-phylogenetic-trees.html"><a href="unrooted-neighbor-joining-phylogenetic-trees.html"><i class="fa fa-check"></i><b>33</b> Unrooted neighbor-joining phylogenetic trees</a>
<ul>
<li class="chapter" data-level="33.1" data-path="unrooted-neighbor-joining-phylogenetic-trees.html"><a href="unrooted-neighbor-joining-phylogenetic-trees.html#preliminaries-14"><i class="fa fa-check"></i><b>33.1</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="33.1.1" data-path="unrooted-neighbor-joining-phylogenetic-trees.html"><a href="unrooted-neighbor-joining-phylogenetic-trees.html#key-functions"><i class="fa fa-check"></i><b>33.1.1</b> Key functions</a></li>
<li class="chapter" data-level="33.1.2" data-path="unrooted-neighbor-joining-phylogenetic-trees.html"><a href="unrooted-neighbor-joining-phylogenetic-trees.html#key-vocab"><i class="fa fa-check"></i><b>33.1.2</b> Key vocab</a></li>
</ul></li>
<li class="chapter" data-level="33.2" data-path="unrooted-neighbor-joining-phylogenetic-trees.html"><a href="unrooted-neighbor-joining-phylogenetic-trees.html#building-an-unrooted-phylogenetic-tree-for-protein-sequences"><i class="fa fa-check"></i><b>33.2</b> Building an unrooted phylogenetic tree for protein sequences</a>
<ul>
<li class="chapter" data-level="33.2.1" data-path="unrooted-neighbor-joining-phylogenetic-trees.html"><a href="unrooted-neighbor-joining-phylogenetic-trees.html#build-tree-with-unrooted_nj_tree"><i class="fa fa-check"></i><b>33.2.1</b> Build tree with <code>unrooted_NJ_tree()</code></a></li>
</ul></li>
<li class="chapter" data-level="33.3" data-path="unrooted-neighbor-joining-phylogenetic-trees.html"><a href="unrooted-neighbor-joining-phylogenetic-trees.html#boostrap-values-indicate-support-for-clades"><i class="fa fa-check"></i><b>33.3</b> Boostrap values indicate support for clades</a></li>
<li class="chapter" data-level="33.4" data-path="unrooted-neighbor-joining-phylogenetic-trees.html"><a href="unrooted-neighbor-joining-phylogenetic-trees.html#branch-lengths-indicate-divergence-between-sequences"><i class="fa fa-check"></i><b>33.4</b> Branch lengths indicate divergence between sequences</a></li>
<li class="chapter" data-level="33.5" data-path="unrooted-neighbor-joining-phylogenetic-trees.html"><a href="unrooted-neighbor-joining-phylogenetic-trees.html#unrooted-trees-lack-an-outgroup"><i class="fa fa-check"></i><b>33.5</b> Unrooted trees lack an outgroup</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="a-complete-bioinformatics-workflow-in-r.html"><a href="a-complete-bioinformatics-workflow-in-r.html"><i class="fa fa-check"></i><b>34</b> A complete bioinformatics workflow in R</a></li>
<li class="chapter" data-level="35" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html"><i class="fa fa-check"></i><b>35</b> “Worked example: Building a phylogeny in R”</a>
<ul>
<li class="chapter" data-level="35.1" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#introduction-5"><i class="fa fa-check"></i><b>35.1</b> Introduction</a></li>
<li class="chapter" data-level="35.2" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#software-preliminaires"><i class="fa fa-check"></i><b>35.2</b> Software Preliminaires</a>
<ul>
<li class="chapter" data-level="35.2.1" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#vocab-6"><i class="fa fa-check"></i><b>35.2.1</b> Vocab</a></li>
<li class="chapter" data-level="35.2.2" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#r-functions-1"><i class="fa fa-check"></i><b>35.2.2</b> R functions</a></li>
<li class="chapter" data-level="35.2.3" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#download-necessary-packages"><i class="fa fa-check"></i><b>35.2.3</b> Download necessary packages</a></li>
<li class="chapter" data-level="35.2.4" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#load-packages-into-memory"><i class="fa fa-check"></i><b>35.2.4</b> Load packages into memory</a></li>
</ul></li>
<li class="chapter" data-level="35.3" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#downloading-macro-molecular-sequences"><i class="fa fa-check"></i><b>35.3</b> Downloading macro-molecular sequences</a></li>
<li class="chapter" data-level="35.4" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#prepping-macromolecular-sequences"><i class="fa fa-check"></i><b>35.4</b> Prepping macromolecular sequences</a></li>
<li class="chapter" data-level="35.5" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#aligning-sequences"><i class="fa fa-check"></i><b>35.5</b> Aligning sequences</a></li>
<li class="chapter" data-level="35.6" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#the-shroom-family-of-genes"><i class="fa fa-check"></i><b>35.6</b> The shroom family of genes</a></li>
<li class="chapter" data-level="35.7" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#downloading-multiple-sequences"><i class="fa fa-check"></i><b>35.7</b> Downloading multiple sequences</a></li>
<li class="chapter" data-level="35.8" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#multiple-sequence-alignment"><i class="fa fa-check"></i><b>35.8</b> Multiple sequence alignment</a>
<ul>
<li class="chapter" data-level="35.8.1" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#building-an-multiple-sequence-alignment-msa"><i class="fa fa-check"></i><b>35.8.1</b> Building an Multiple Sequence Alignment (MSA)</a></li>
<li class="chapter" data-level="35.8.2" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#viewing-an-msa"><i class="fa fa-check"></i><b>35.8.2</b> Viewing an MSA</a></li>
</ul></li>
<li class="chapter" data-level="35.9" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#genetic-distance."><i class="fa fa-check"></i><b>35.9</b> Genetic distance.</a></li>
<li class="chapter" data-level="35.10" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#phylognetic-trees-finally"><i class="fa fa-check"></i><b>35.10</b> Phylognetic trees (finally!)</a>
<ul>
<li class="chapter" data-level="35.10.1" data-path="worked-example-building-a-phylogeny-in-r.html"><a href="worked-example-building-a-phylogeny-in-r.html#plotting-phylogenetic-trees"><i class="fa fa-check"></i><b>35.10.1</b> Plotting phylogenetic trees</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="36" data-path="logarithms-in-r.html"><a href="logarithms-in-r.html"><i class="fa fa-check"></i><b>36</b> Logarithms in R</a></li>
<li class="chapter" data-level="" data-path=""><a href="#part-appendices"><i class="fa fa-check"></i>(PART) Appendices</a>
<ul>
<li><a href="#section"></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-01-getting-access-to-r.html"><a href="appendix-01-getting-access-to-r.html"><i class="fa fa-check"></i>Appendix 01: Getting access to R</a>
<ul>
<li class="chapter" data-level="36.1" data-path="appendix-01-getting-access-to-r.html"><a href="appendix-01-getting-access-to-r.html#getting-started-with-r-and-rstudio"><i class="fa fa-check"></i><b>36.1</b> Getting Started With R and RStudio</a>
<ul>
<li class="chapter" data-level="36.1.1" data-path="appendix-01-getting-access-to-r.html"><a href="appendix-01-getting-access-to-r.html#rstudio-cloud"><i class="fa fa-check"></i><b>36.1.1</b> RStudio Cloud</a></li>
<li class="chapter" data-level="36.1.2" data-path="appendix-01-getting-access-to-r.html"><a href="appendix-01-getting-access-to-r.html#getting-r-onto-your-own-computer"><i class="fa fa-check"></i><b>36.1.2</b> Getting R onto your own computer</a></li>
<li class="chapter" data-level="36.1.3" data-path="appendix-01-getting-access-to-r.html"><a href="appendix-01-getting-access-to-r.html#getting-rstudio-onto-your-computer"><i class="fa fa-check"></i><b>36.1.3</b> Getting RStudio onto your computer</a></li>
<li class="chapter" data-level="36.1.4" data-path="appendix-01-getting-access-to-r.html"><a href="appendix-01-getting-access-to-r.html#keep-r-and-rstudio-current"><i class="fa fa-check"></i><b>36.1.4</b> Keep R and RStudio current</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="getting-started-with-r-itself-or-not.html"><a href="getting-started-with-r-itself-or-not.html"><i class="fa fa-check"></i>Getting started with R itself (or not)</a>
<ul>
<li class="chapter" data-level="" data-path="getting-started-with-r-itself-or-not.html"><a href="getting-started-with-r-itself-or-not.html#vocabulary-2"><i class="fa fa-check"></i>Vocabulary</a></li>
<li class="chapter" data-level="" data-path="getting-started-with-r-itself-or-not.html"><a href="getting-started-with-r-itself-or-not.html#r-commands"><i class="fa fa-check"></i>R commands</a></li>
<li class="chapter" data-level="36.2" data-path="getting-started-with-r-itself-or-not.html"><a href="getting-started-with-r-itself-or-not.html#help"><i class="fa fa-check"></i><b>36.2</b> Help!</a>
<ul>
<li class="chapter" data-level="36.2.1" data-path="getting-started-with-r-itself-or-not.html"><a href="getting-started-with-r-itself-or-not.html#getting-help-from-r"><i class="fa fa-check"></i><b>36.2.1</b> Getting “help” from R</a></li>
<li class="chapter" data-level="36.2.2" data-path="getting-started-with-r-itself-or-not.html"><a href="getting-started-with-r-itself-or-not.html#getting-help-from-the-internet"><i class="fa fa-check"></i><b>36.2.2</b> Getting help from the internet</a></li>
<li class="chapter" data-level="36.2.3" data-path="getting-started-with-r-itself-or-not.html"><a href="getting-started-with-r-itself-or-not.html#getting-help-from-online-forums"><i class="fa fa-check"></i><b>36.2.3</b> Getting help from online forums</a></li>
<li class="chapter" data-level="36.2.4" data-path="getting-started-with-r-itself-or-not.html"><a href="getting-started-with-r-itself-or-not.html#getting-help-from-twitter"><i class="fa fa-check"></i><b>36.2.4</b> Getting help from twitter</a></li>
</ul></li>
<li class="chapter" data-level="36.3" data-path="getting-started-with-r-itself-or-not.html"><a href="getting-started-with-r-itself-or-not.html#other-features-of-rstudio"><i class="fa fa-check"></i><b>36.3</b> Other features of RStudio</a>
<ul>
<li class="chapter" data-level="36.3.1" data-path="getting-started-with-r-itself-or-not.html"><a href="getting-started-with-r-itself-or-not.html#ajusting-pane-the-layout"><i class="fa fa-check"></i><b>36.3.1</b> Ajusting pane the layout</a></li>
<li class="chapter" data-level="36.3.2" data-path="getting-started-with-r-itself-or-not.html"><a href="getting-started-with-r-itself-or-not.html#adjusting-size-of-windows"><i class="fa fa-check"></i><b>36.3.2</b> Adjusting size of windows</a></li>
</ul></li>
<li class="chapter" data-level="36.4" data-path="getting-started-with-r-itself-or-not.html"><a href="getting-started-with-r-itself-or-not.html#practice-optional"><i class="fa fa-check"></i><b>36.4</b> Practice (OPTIONAL)</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="blast-summary.html"><a href="blast-summary.html"><i class="fa fa-check"></i><b>37</b> BLAST Summary</a>
<ul>
<li class="chapter" data-level="37.1" data-path="blast-summary.html"><a href="blast-summary.html#blast-overview"><i class="fa fa-check"></i><b>37.1</b> BLAST Overview</a>
<ul>
<li class="chapter" data-level="37.1.1" data-path="blast-summary.html"><a href="blast-summary.html#why-do-a-blast-search"><i class="fa fa-check"></i><b>37.1.1</b> Why do a BLAST search?</a></li>
<li class="chapter" data-level="37.1.2" data-path="blast-summary.html"><a href="blast-summary.html#what-does-blast-let-you-do"><i class="fa fa-check"></i><b>37.1.2</b> What does BLAST let you do?</a></li>
</ul></li>
<li class="chapter" data-level="37.2" data-path="blast-summary.html"><a href="blast-summary.html#blast-recipe"><i class="fa fa-check"></i><b>37.2</b> BLAST recipe</a></li>
<li class="chapter" data-level="37.3" data-path="blast-summary.html"><a href="blast-summary.html#modules-in-the-blast-workflow-and-algorithm"><i class="fa fa-check"></i><b>37.3</b> Modules in the BLAST Workflow and Algorithm</a>
<ul>
<li class="chapter" data-level="37.3.1" data-path="blast-summary.html"><a href="blast-summary.html#module-1-setup-query-sequence-protein-blast-oriented"><i class="fa fa-check"></i><b>37.3.1</b> Module 1: Setup query sequence (Protein BLAST oriented)</a></li>
<li class="chapter" data-level="37.3.2" data-path="blast-summary.html"><a href="blast-summary.html#module-2-scanning-database-for-high-scoring-words"><i class="fa fa-check"></i><b>37.3.2</b> Module 2: Scanning database for high-scoring words</a></li>
<li class="chapter" data-level="37.3.3" data-path="blast-summary.html"><a href="blast-summary.html#module-3-traceback"><i class="fa fa-check"></i><b>37.3.3</b> Module 3: Traceback</a></li>
</ul></li>
<li class="chapter" data-level="37.4" data-path="blast-summary.html"><a href="blast-summary.html#blast-alignment-statistics"><i class="fa fa-check"></i><b>37.4</b> BLAST alignment statistics</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="blast-alignment-score-distribution.html"><a href="blast-alignment-score-distribution.html"><i class="fa fa-check"></i><b>38</b> BLAST Alignment score distribution</a>
<ul>
<li class="chapter" data-level="38.1" data-path="blast-alignment-score-distribution.html"><a href="blast-alignment-score-distribution.html#packages-7"><i class="fa fa-check"></i><b>38.1</b> Packages</a></li>
<li class="chapter" data-level="38.2" data-path="blast-alignment-score-distribution.html"><a href="blast-alignment-score-distribution.html#distributions-of-alignment-scores"><i class="fa fa-check"></i><b>38.2</b> Distributions of alignment scores</a></li>
<li class="chapter" data-level="38.3" data-path="blast-alignment-score-distribution.html"><a href="blast-alignment-score-distribution.html#simulating-data"><i class="fa fa-check"></i><b>38.3</b> Simulating data</a></li>
<li class="chapter" data-level="38.4" data-path="blast-alignment-score-distribution.html"><a href="blast-alignment-score-distribution.html#lots-of-data-in-biology-is-normal"><i class="fa fa-check"></i><b>38.4</b> Lots of data in biology is normal</a></li>
<li class="chapter" data-level="38.5" data-path="blast-alignment-score-distribution.html"><a href="blast-alignment-score-distribution.html#simulating-the-normal-distribution"><i class="fa fa-check"></i><b>38.5</b> Simulating the normal distribution</a></li>
<li class="chapter" data-level="38.6" data-path="blast-alignment-score-distribution.html"><a href="blast-alignment-score-distribution.html#the-extreme-value-distribution"><i class="fa fa-check"></i><b>38.6</b> The extreme value distribution</a></li>
<li class="chapter" data-level="38.7" data-path="blast-alignment-score-distribution.html"><a href="blast-alignment-score-distribution.html#replicating-figure-4.14"><i class="fa fa-check"></i><b>38.7</b> Replicating Figure 4.14</a></li>
<li class="chapter" data-level="38.8" data-path="blast-alignment-score-distribution.html"><a href="blast-alignment-score-distribution.html#why-do-we-care"><i class="fa fa-check"></i><b>38.8</b> Why do we care?</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><i class="fa fa-check"></i><b>39</b> Calculating E values, Bit scores, and P-values from BLAST output</a>
<ul>
<li class="chapter" data-level="39.1" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#introduction-6"><i class="fa fa-check"></i><b>39.1</b> Introduction</a></li>
<li class="chapter" data-level="39.2" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#case-study"><i class="fa fa-check"></i><b>39.2</b> Case Study</a></li>
<li class="chapter" data-level="39.3" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#blast-statistics"><i class="fa fa-check"></i><b>39.3</b> BLAST Statistics</a></li>
<li class="chapter" data-level="39.4" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#dotplot"><i class="fa fa-check"></i><b>39.4</b> Dotplot</a>
<ul>
<li class="chapter" data-level="39.4.1" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#dotplot-in-r---optional-experimental-code"><i class="fa fa-check"></i><b>39.4.1</b> Dotplot in R - optional, experimental code</a></li>
</ul></li>
<li class="chapter" data-level="39.5" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#blast-search-summary"><i class="fa fa-check"></i><b>39.5</b> BLAST “Search Summary”</a></li>
<li class="chapter" data-level="39.6" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#blast-alignments"><i class="fa fa-check"></i><b>39.6</b> BLAST Alignments</a></li>
<li class="chapter" data-level="39.7" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#equations"><i class="fa fa-check"></i><b>39.7</b> Equations</a>
<ul>
<li class="chapter" data-level="39.7.1" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#e-value-eq-4.5-pg-142"><i class="fa fa-check"></i><b>39.7.1</b> E value (eq 4.5, pg 142)</a></li>
</ul></li>
<li class="chapter" data-level="39.8" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#bit-scores-s"><i class="fa fa-check"></i><b>39.8</b> Bit Scores (S’)</a></li>
<li class="chapter" data-level="39.9" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#e-from-bit-scores"><i class="fa fa-check"></i><b>39.9</b> E from Bit scores</a></li>
<li class="chapter" data-level="39.10" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#p-values"><i class="fa fa-check"></i><b>39.10</b> P values</a></li>
<li class="chapter" data-level="39.11" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#repliminaries"><i class="fa fa-check"></i><b>39.11</b> Repliminaries</a></li>
<li class="chapter" data-level="39.12" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#concepts"><i class="fa fa-check"></i><b>39.12</b> Concepts</a></li>
<li class="chapter" data-level="39.13" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#functions-6"><i class="fa fa-check"></i><b>39.13</b> Functions</a></li>
<li class="chapter" data-level="39.14" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#introduction-7"><i class="fa fa-check"></i><b>39.14</b> Introduction</a></li>
<li class="chapter" data-level="39.15" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#number-of-rooted-trees"><i class="fa fa-check"></i><b>39.15</b> Number of rooted trees</a></li>
<li class="chapter" data-level="39.16" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#number-of-rooted-trees-in-r"><i class="fa fa-check"></i><b>39.16</b> Number of rooted trees in R</a>
<ul>
<li class="chapter" data-level="39.16.1" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#unique-topologies-versus-rotations"><i class="fa fa-check"></i><b>39.16.1</b> Unique topologies versus rotations</a></li>
</ul></li>
<li class="chapter" data-level="39.17" data-path="calculating-e-values-bit-scores-and-p-values-from-blast-output.html"><a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html#bilography"><i class="fa fa-check"></i><b>39.17</b> Bilography</a></li>
</ul></li>
<li class="chapter" data-level="40" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html"><i class="fa fa-check"></i><b>40</b> UPGMA the hard way</a>
<ul>
<li class="chapter" data-level="40.1" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#introudction-to-upgma"><i class="fa fa-check"></i><b>40.1</b> Introudction to UPGMA</a></li>
<li class="chapter" data-level="40.2" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#preliminaries-15"><i class="fa fa-check"></i><b>40.2</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="40.2.1" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#r-libraries"><i class="fa fa-check"></i><b>40.2.1</b> R Libraries</a></li>
<li class="chapter" data-level="40.2.2" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#custom-function-well-use"><i class="fa fa-check"></i><b>40.2.2</b> Custom function we’ll use</a></li>
</ul></li>
<li class="chapter" data-level="40.3" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#data-matrix"><i class="fa fa-check"></i><b>40.3</b> Data matrix</a>
<ul>
<li class="chapter" data-level="40.3.1" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#building-the-matrix"><i class="fa fa-check"></i><b>40.3.1</b> Building the matrix</a></li>
</ul></li>
<li class="chapter" data-level="40.4" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#what-does-this-distance-matrix-represent"><i class="fa fa-check"></i><b>40.4</b> What does this distance matrix represent?</a>
<ul>
<li class="chapter" data-level="40.4.1" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#genetic-distances-conceptualized-as-pairwise-linear-distances"><i class="fa fa-check"></i><b>40.4.1</b> Genetic distances conceptualized as pairwise linear distances</a></li>
<li class="chapter" data-level="40.4.2" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#genetic-distances-conceptualized-as-2d-map-of-linear-distances"><i class="fa fa-check"></i><b>40.4.2</b> Genetic distances conceptualized as 2D map of linear distances</a></li>
</ul></li>
<li class="chapter" data-level="40.5" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#from-linear-distances-to-tree-distances"><i class="fa fa-check"></i><b>40.5</b> From linear distances to “tree distances”</a></li>
<li class="chapter" data-level="40.6" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#the-upgma-algorithm"><i class="fa fa-check"></i><b>40.6</b> The UPGMA algorithm</a>
<ul>
<li class="chapter" data-level="40.6.1" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#step-1-find-the-2-taxa-that-are-currently-closest-together"><i class="fa fa-check"></i><b>40.6.1</b> Step 1: find the 2 taxa that are currently closest together</a></li>
<li class="chapter" data-level="40.6.2" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#step-2-calculate-the-branch-lengths-connect-the-taxa-to-their-shared-node"><i class="fa fa-check"></i><b>40.6.2</b> Step 2: calculate the branch lengths connect the taxa to their shared node</a></li>
<li class="chapter" data-level="40.6.3" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#step-3a-determine-if-the-algorithm-is-done"><i class="fa fa-check"></i><b>40.6.3</b> Step 3a: determine if the algorithm is done</a></li>
<li class="chapter" data-level="40.6.4" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#step-3a-continue-on-if-needed-and-combine-the-previous-cluster-into-cluster-u"><i class="fa fa-check"></i><b>40.6.4</b> Step 3a: Continue on if needed and combine the previous cluster into cluster “u”</a></li>
<li class="chapter" data-level="40.6.5" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#step-4-determine-the-distance-from-u-to-the-other-remaining-clusters."><i class="fa fa-check"></i><b>40.6.5</b> Step 4: Determine the distance from u to the other remaining clusters.</a></li>
<li class="chapter" data-level="40.6.6" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#step-5-create-a-new-matrix"><i class="fa fa-check"></i><b>40.6.6</b> Step 5: Create a new matrix</a></li>
<li class="chapter" data-level="40.6.7" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#key-step-calculating-the-distance-from-a-clade-to-the-remaining-taxa"><i class="fa fa-check"></i><b>40.6.7</b> Key step: calculating the distance from a clade to the remaining taxa</a></li>
</ul></li>
<li class="chapter" data-level="40.7" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#calculate-2d-representation"><i class="fa fa-check"></i><b>40.7</b> Calculate 2D representation</a></li>
<li class="chapter" data-level="40.8" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#algorithm---round-1"><i class="fa fa-check"></i><b>40.8</b> Algorithm - round 1</a>
<ul>
<li class="chapter" data-level="40.8.1" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#determine-minimum-value-in-current-matrix"><i class="fa fa-check"></i><b>40.8.1</b> Determine minimum value in current matrix</a></li>
<li class="chapter" data-level="40.8.2" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#combine-species-into-clade"><i class="fa fa-check"></i><b>40.8.2</b> Combine species into clade</a></li>
<li class="chapter" data-level="40.8.3" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#calculate-branch-length"><i class="fa fa-check"></i><b>40.8.3</b> Calculate branch length</a></li>
<li class="chapter" data-level="40.8.4" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#calculate-distance-from-clade-to-all-other-points"><i class="fa fa-check"></i><b>40.8.4</b> Calculate distance from clade to all other points</a></li>
<li class="chapter" data-level="40.8.5" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#update-matrix-with-new-distance"><i class="fa fa-check"></i><b>40.8.5</b> Update matrix with new distance</a></li>
</ul></li>
<li class="chapter" data-level="40.9" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#algorithm---next-round"><i class="fa fa-check"></i><b>40.9</b> Algorithm - next round</a>
<ul>
<li class="chapter" data-level="40.9.1" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#combine-species-into-clade-1"><i class="fa fa-check"></i><b>40.9.1</b> Combine species into clade</a></li>
<li class="chapter" data-level="40.9.2" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#calculate-branch-length-1"><i class="fa fa-check"></i><b>40.9.2</b> Calculate branch length</a></li>
<li class="chapter" data-level="40.9.3" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#recalculate-distance-from-abe-to-all-remainign-taxa"><i class="fa fa-check"></i><b>40.9.3</b> Recalculate distance from abe to all remainign taxa</a></li>
<li class="chapter" data-level="40.9.4" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#update-the-matrix"><i class="fa fa-check"></i><b>40.9.4</b> Update the matrix</a></li>
</ul></li>
<li class="chapter" data-level="40.10" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#next-iteration"><i class="fa fa-check"></i><b>40.10</b> Next iteration</a>
<ul>
<li class="chapter" data-level="40.10.1" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#calculate-branch-lengths"><i class="fa fa-check"></i><b>40.10.1</b> Calculate branch lengths</a></li>
<li class="chapter" data-level="40.10.2" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#combine-species-into-clade-2"><i class="fa fa-check"></i><b>40.10.2</b> Combine species into clade</a></li>
<li class="chapter" data-level="40.10.3" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#calculate-branch-length-2"><i class="fa fa-check"></i><b>40.10.3</b> Calculate branch length</a></li>
<li class="chapter" data-level="40.10.4" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#distance-of-c-to-abe-and-d-to-abe"><i class="fa fa-check"></i><b>40.10.4</b> Distance of c to abe and d to abe</a></li>
</ul></li>
<li class="chapter" data-level="40.11" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#finish-up"><i class="fa fa-check"></i><b>40.11</b> Finish up</a>
<ul>
<li class="chapter" data-level="40.11.1" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#combine-species-into-clade-3"><i class="fa fa-check"></i><b>40.11.1</b> Combine species into clade</a></li>
<li class="chapter" data-level="40.11.2" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#calculate-branch-length-3"><i class="fa fa-check"></i><b>40.11.2</b> Calculate branch length</a></li>
</ul></li>
<li class="chapter" data-level="40.12" data-path="upgma-the-hard-way.html"><a href="upgma-the-hard-way.html#finalizing-branch-lengths"><i class="fa fa-check"></i><b>40.12</b> Finalizing branch lengths</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="representing-phylogenetic-trees-in-newick-format.html"><a href="representing-phylogenetic-trees-in-newick-format.html"><i class="fa fa-check"></i><b>41</b> Representing phylogenetic trees in Newick format</a>
<ul>
<li class="chapter" data-level="41.1" data-path="representing-phylogenetic-trees-in-newick-format.html"><a href="representing-phylogenetic-trees-in-newick-format.html#vocab-7"><i class="fa fa-check"></i><b>41.1</b> Vocab</a></li>
<li class="chapter" data-level="41.2" data-path="representing-phylogenetic-trees-in-newick-format.html"><a href="representing-phylogenetic-trees-in-newick-format.html#introduction-8"><i class="fa fa-check"></i><b>41.2</b> Introduction</a></li>
<li class="chapter" data-level="41.3" data-path="representing-phylogenetic-trees-in-newick-format.html"><a href="representing-phylogenetic-trees-in-newick-format.html#trees-with-three-taxa"><i class="fa fa-check"></i><b>41.3</b> Trees with three taxa</a></li>
<li class="chapter" data-level="41.4" data-path="representing-phylogenetic-trees-in-newick-format.html"><a href="representing-phylogenetic-trees-in-newick-format.html#trees-with-four-taxa"><i class="fa fa-check"></i><b>41.4</b> Trees with four taxa</a></li>
</ul></li>
<li class="chapter" data-level="42" data-path="plotting-trees-from-newick-notation-in-r.html"><a href="plotting-trees-from-newick-notation-in-r.html"><i class="fa fa-check"></i><b>42</b> Plotting trees from Newick notation in R</a>
<ul>
<li class="chapter" data-level="42.1" data-path="plotting-trees-from-newick-notation-in-r.html"><a href="plotting-trees-from-newick-notation-in-r.html#preliminaries-16"><i class="fa fa-check"></i><b>42.1</b> Preliminaries</a></li>
<li class="chapter" data-level="42.2" data-path="plotting-trees-from-newick-notation-in-r.html"><a href="plotting-trees-from-newick-notation-in-r.html#note"><i class="fa fa-check"></i><b>42.2</b> Note</a></li>
<li class="chapter" data-level="42.3" data-path="plotting-trees-from-newick-notation-in-r.html"><a href="plotting-trees-from-newick-notation-in-r.html#taxa-tree-in-newick"><i class="fa fa-check"></i><b>42.3</b> 3 taxa tree in Newick</a></li>
<li class="chapter" data-level="42.4" data-path="plotting-trees-from-newick-notation-in-r.html"><a href="plotting-trees-from-newick-notation-in-r.html#taxa-tree-in-newick-1"><i class="fa fa-check"></i><b>42.4</b> 4 taxa tree in Newick</a></li>
<li class="chapter" data-level="42.5" data-path="plotting-trees-from-newick-notation-in-r.html"><a href="plotting-trees-from-newick-notation-in-r.html#taxa-in-newick-format"><i class="fa fa-check"></i><b>42.5</b> 5 taxa in Newick Format</a></li>
<li class="chapter" data-level="42.6" data-path="plotting-trees-from-newick-notation-in-r.html"><a href="plotting-trees-from-newick-notation-in-r.html#many-taxa-tree"><i class="fa fa-check"></i><b>42.6</b> Many-taxa tree</a></li>
<li class="chapter" data-level="42.7" data-path="plotting-trees-from-newick-notation-in-r.html"><a href="plotting-trees-from-newick-notation-in-r.html#newick-and-branch-lengths"><i class="fa fa-check"></i><b>42.7</b> Newick and Branch lengths</a></li>
<li class="chapter" data-level="42.8" data-path="plotting-trees-from-newick-notation-in-r.html"><a href="plotting-trees-from-newick-notation-in-r.html#additional-reading"><i class="fa fa-check"></i><b>42.8</b> Additional Reading</a></li>
</ul></li>
<li class="chapter" data-level="43" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><i class="fa fa-check"></i><b>43</b> Phylogenetic trees using the UPGMA clustering algoirthm</a>
<ul>
<li class="chapter" data-level="43.1" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#introduction-9"><i class="fa fa-check"></i><b>43.1</b> Introduction</a></li>
<li class="chapter" data-level="43.2" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#preliminaries-17"><i class="fa fa-check"></i><b>43.2</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="43.2.1" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#vocab-8"><i class="fa fa-check"></i><b>43.2.1</b> Vocab</a></li>
<li class="chapter" data-level="43.2.2" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#general-r-functions"><i class="fa fa-check"></i><b>43.2.2</b> General R functions</a></li>
<li class="chapter" data-level="43.2.3" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#specific-functions"><i class="fa fa-check"></i><b>43.2.3</b> Specific functions</a></li>
</ul></li>
<li class="chapter" data-level="43.3" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#sequence-comparisons"><i class="fa fa-check"></i><b>43.3</b> Sequence comparisons</a></li>
<li class="chapter" data-level="43.4" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#distance-matrices"><i class="fa fa-check"></i><b>43.4</b> Distance matrices</a></li>
<li class="chapter" data-level="43.5" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#from-a-distance-matrix-to-phylogenetic-tree"><i class="fa fa-check"></i><b>43.5</b> From a distance matrix to phylogenetic tree</a></li>
<li class="chapter" data-level="43.6" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#distance-matrix-in-r-from-raw-sequences"><i class="fa fa-check"></i><b>43.6</b> Distance matrix in R from raw sequences</a></li>
<li class="chapter" data-level="43.7" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#distance-matrix-in-r-from-normal-matrix"><i class="fa fa-check"></i><b>43.7</b> Distance matrix in R from normal matrix</a></li>
<li class="chapter" data-level="43.8" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#upgma-in-r"><i class="fa fa-check"></i><b>43.8</b> UPGMA in R</a></li>
<li class="chapter" data-level="43.9" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#how-upgma-clustering-works"><i class="fa fa-check"></i><b>43.9</b> How UPGMA clustering works</a>
<ul>
<li class="chapter" data-level="43.9.1" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#challenge"><i class="fa fa-check"></i><b>43.9.1</b> Challenge</a></li>
</ul></li>
<li class="chapter" data-level="43.10" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#further-information"><i class="fa fa-check"></i><b>43.10</b> Further information</a>
<ul>
<li class="chapter" data-level="43.10.1" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#general-info"><i class="fa fa-check"></i><b>43.10.1</b> General info</a></li>
<li class="chapter" data-level="43.10.2" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#worked-examples"><i class="fa fa-check"></i><b>43.10.2</b> Worked examples:</a></li>
<li class="chapter" data-level="43.10.3" data-path="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html"><a href="phylogenetic-trees-using-the-upgma-clustering-algoirthm.html#additional-notes"><i class="fa fa-check"></i><b>43.10.3</b> Additional notes:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="44" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><i class="fa fa-check"></i><b>44</b> Tutorial: Writing functions to calculate the number of phylogenetic trees</a>
<ul>
<li class="chapter" data-level="44.1" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#repliminaries-1"><i class="fa fa-check"></i><b>44.1</b> Repliminaries</a>
<ul>
<li class="chapter" data-level="44.1.1" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#functions-7"><i class="fa fa-check"></i><b>44.1.1</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="44.2" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#concepts-1"><i class="fa fa-check"></i><b>44.2</b> Concepts</a>
<ul>
<li class="chapter" data-level="44.2.1" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#vocab-9"><i class="fa fa-check"></i><b>44.2.1</b> Vocab:</a></li>
<li class="chapter" data-level="44.2.2" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#packages-8"><i class="fa fa-check"></i><b>44.2.2</b> Packages:</a></li>
</ul></li>
<li class="chapter" data-level="44.3" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#introduction-10"><i class="fa fa-check"></i><b>44.3</b> Introduction</a></li>
<li class="chapter" data-level="44.4" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#number-of-rooted-trees-1"><i class="fa fa-check"></i><b>44.4</b> Number of rooted trees</a></li>
<li class="chapter" data-level="44.5" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#number-of-rooted-trees-in-r-1"><i class="fa fa-check"></i><b>44.5</b> Number of rooted trees in R</a></li>
<li class="chapter" data-level="44.6" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#functions-in-r-1"><i class="fa fa-check"></i><b>44.6</b> Functions in R</a></li>
<li class="chapter" data-level="44.7" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#function-to-calculate-the-number-of-possible-phylogenetic-trees"><i class="fa fa-check"></i><b>44.7</b> Function to calculate the number of possible phylogenetic trees</a></li>
<li class="chapter" data-level="44.8" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#vectorized-inputs-to-functions"><i class="fa fa-check"></i><b>44.8</b> Vectorized inputs to functions</a></li>
<li class="chapter" data-level="44.9" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#adding-conditional-statements"><i class="fa fa-check"></i><b>44.9</b> Adding conditional statements</a></li>
<li class="chapter" data-level="44.10" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#adding-multiple-conditional-statements"><i class="fa fa-check"></i><b>44.10</b> Adding multiple conditional statements</a></li>
<li class="chapter" data-level="44.11" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#adding-additional-arguments"><i class="fa fa-check"></i><b>44.11</b> Adding additional arguments</a></li>
<li class="chapter" data-level="44.12" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#assignment-_un_rooted-trees"><i class="fa fa-check"></i><b>44.12</b> Assignment: _un_rooted trees</a></li>
<li class="chapter" data-level="44.13" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#assignment-part-1"><i class="fa fa-check"></i><b>44.13</b> Assignment part 1</a>
<ul>
<li class="chapter" data-level="44.13.1" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#part-1-answer"><i class="fa fa-check"></i><b>44.13.1</b> Part 1 answer</a></li>
</ul></li>
<li class="chapter" data-level="44.14" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#assignment-part-2"><i class="fa fa-check"></i><b>44.14</b> Assignment part 2</a>
<ul>
<li class="chapter" data-level="44.14.1" data-path="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html"><a href="tutorial-writing-functions-to-calculate-the-number-of-phylogenetic-trees.html#answer"><i class="fa fa-check"></i><b>44.14.1</b> Answer</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://brouwern.github.io/lbrb/" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Little Book of R for Bioinformatics 2.0</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="upgma-the-hard-way" class="section level1" number="40">
<h1><span class="header-section-number">Chapter 40</span> UPGMA the hard way</h1>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="upgma-the-hard-way.html#cb842-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(compbio4all)</span></code></pre></div>
<div id="introudction-to-upgma" class="section level2" number="40.1">
<h2><span class="header-section-number">40.1</span> Introudction to UPGMA</h2>
<ul>
<li>UPGMA is a basic <strong>clustering algorithm</strong> which can be used for building phylognetic tree from <strong>distance matrices</strong>.<br />
</li>
<li>It still has some applications because it is fast, but it has mostly beenn replaced by Neighbor Joining and Minimum Evolution methods.</li>
<li>UPGMA is still useful for teaching the basic steps involved in data clustering and building trees.</li>
<li>UPGMA is a particular variant of a general class of algorithms. Another varient is WPGMA.</li>
</ul>
</div>
<div id="preliminaries-15" class="section level2" number="40.2">
<h2><span class="header-section-number">40.2</span> Preliminaries</h2>
<div id="r-libraries" class="section level3" number="40.2.1">
<h3><span class="header-section-number">40.2.1</span> R Libraries</h3>
<p>The phangorn package contains the functions</p>
<ul>
<li>upgma()</li>
<li>wpgma()</li>
</ul>
<p>The ape package has the function nj() for neighbor joinging, which is useful for comparison to UPGMA.</p>
<div id="phylogenetic-libraries" class="section level4" number="40.2.1.1">
<h4><span class="header-section-number">40.2.1.1</span> Phylogenetic libraries</h4>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="upgma-the-hard-way.html#cb843-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;ape&quot;)</span></span>
<span id="cb843-2"><a href="upgma-the-hard-way.html#cb843-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;phangorn&quot;)</span></span>
<span id="cb843-3"><a href="upgma-the-hard-way.html#cb843-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb843-4"><a href="upgma-the-hard-way.html#cb843-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phangorn)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;phangorn&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:igraph&#39;:
## 
##     diversity</code></pre>
</div>
<div id="plotting-libraries" class="section level4" number="40.2.1.2">
<h4><span class="header-section-number">40.2.1.2</span> Plotting libraries</h4>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="upgma-the-hard-way.html#cb846-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;plotrix&quot;)</span></span>
<span id="cb846-2"><a href="upgma-the-hard-way.html#cb846-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotrix)</span></code></pre></div>
</div>
</div>
<div id="custom-function-well-use" class="section level3" number="40.2.2">
<h3><span class="header-section-number">40.2.2</span> Custom function we’ll use</h3>
<p>To help us understand clustering and UPGMA I’ve written a cusome function.</p>
<p>This function, plot_dist_as_nmds(), will make a 2-dimensional (2D) representation of the distance matrices we’ll be working with. This is only an approximation and will occassionally result in distorions.</p>
<p>What this function does is take a <strong>distance matix</strong> and attempt to plot the data as if they were in 2-dimensional space. If we were giving it the distance between building on campus it would plot a reasonable map. Since we’ll be plotting data that isn’t physical distance but genetic distances this will not be a real evolutionary tree. The intent here is to help you build your intuition about what a distane matrix is.</p>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="upgma-the-hard-way.html#cb847-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Load ALL of this code</span></span>
<span id="cb847-2"><a href="upgma-the-hard-way.html#cb847-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb847-3"><a href="upgma-the-hard-way.html#cb847-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: ylim and xlim are current hard coded</span></span>
<span id="cb847-4"><a href="upgma-the-hard-way.html#cb847-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb847-5"><a href="upgma-the-hard-way.html#cb847-5" aria-hidden="true" tabindex="-1"></a>plot_dist_as_nmds <span class="ot">&lt;-</span> <span class="cf">function</span>(mat, <span class="at">x.lim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>), <span class="at">y.lim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>)){</span>
<span id="cb847-6"><a href="upgma-the-hard-way.html#cb847-6" aria-hidden="true" tabindex="-1"></a>  matno0 <span class="ot">&lt;-</span> mat</span>
<span id="cb847-7"><a href="upgma-the-hard-way.html#cb847-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb847-8"><a href="upgma-the-hard-way.html#cb847-8" aria-hidden="true" tabindex="-1"></a>matno0[<span class="fu">is.na</span>(matno0)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb847-9"><a href="upgma-the-hard-way.html#cb847-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb847-10"><a href="upgma-the-hard-way.html#cb847-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb847-11"><a href="upgma-the-hard-way.html#cb847-11" aria-hidden="true" tabindex="-1"></a>d2  <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">cmdscale</span>(matno0, <span class="at">add =</span>T)</span>
<span id="cb847-12"><a href="upgma-the-hard-way.html#cb847-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> d2<span class="sc">$</span>points[,<span class="dv">1</span>]</span>
<span id="cb847-13"><a href="upgma-the-hard-way.html#cb847-13" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> d2<span class="sc">$</span>points[,<span class="dv">2</span>]</span>
<span id="cb847-14"><a href="upgma-the-hard-way.html#cb847-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y, <span class="at">main =</span> <span class="st">&quot;APPROXIMATE 2D distances&quot;</span>,</span>
<span id="cb847-15"><a href="upgma-the-hard-way.html#cb847-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> x.lim, </span>
<span id="cb847-16"><a href="upgma-the-hard-way.html#cb847-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> y.lim)</span>
<span id="cb847-17"><a href="upgma-the-hard-way.html#cb847-17" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(x, y, <span class="at">labels =</span> <span class="fu">row.names</span>(d2<span class="sc">$</span>points), <span class="at">cex=</span><span class="dv">3</span>)</span>
<span id="cb847-18"><a href="upgma-the-hard-way.html#cb847-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb847-19"><a href="upgma-the-hard-way.html#cb847-19" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(d2)</span>
<span id="cb847-20"><a href="upgma-the-hard-way.html#cb847-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb847-21"><a href="upgma-the-hard-way.html#cb847-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="data-matrix" class="section level2" number="40.3">
<h2><span class="header-section-number">40.3</span> Data matrix</h2>
<p>We’ll use data from a study that built a tree using rRNA from bacteria.</p>
<p>The data and a worked example are available at <a href="https://en.wikipedia.org/wiki/UPGMA#First_step" class="uri">https://en.wikipedia.org/wiki/UPGMA#First_step</a></p>
<p>This particular matrix is set up as the number of bases that are different between each sequence. (In the next unit we’ll discuss how they didn’t use just a simple count of the differences).</p>
<div id="building-the-matrix" class="section level3" number="40.3.1">
<h3><span class="header-section-number">40.3.1</span> Building the matrix</h3>
<p>One way to make the data is to use the rbind() individual vectors as rows</p>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="upgma-the-hard-way.html#cb848-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The data</span></span>
<span id="cb848-2"><a href="upgma-the-hard-way.html#cb848-2" aria-hidden="true" tabindex="-1"></a><span class="co">#      a   b   c   d   e</span></span>
<span id="cb848-3"><a href="upgma-the-hard-way.html#cb848-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,    <span class="dv">17</span>, <span class="dv">21</span>, <span class="dv">31</span>, <span class="dv">23</span>)</span>
<span id="cb848-4"><a href="upgma-the-hard-way.html#cb848-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">0</span>,    <span class="dv">30</span>, <span class="dv">34</span>, <span class="dv">21</span>)</span>
<span id="cb848-5"><a href="upgma-the-hard-way.html#cb848-5" aria-hidden="true" tabindex="-1"></a>c   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">30</span>, <span class="dv">0</span>,  <span class="dv">28</span>, <span class="dv">39</span>)</span>
<span id="cb848-6"><a href="upgma-the-hard-way.html#cb848-6" aria-hidden="true" tabindex="-1"></a>d   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">34</span>, <span class="dv">28</span>,    <span class="dv">0</span>, <span class="dv">43</span>)</span>
<span id="cb848-7"><a href="upgma-the-hard-way.html#cb848-7" aria-hidden="true" tabindex="-1"></a>e   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">23</span>, <span class="dv">21</span>, <span class="dv">39</span>, <span class="dv">43</span>,    <span class="dv">0</span>)</span>
<span id="cb848-8"><a href="upgma-the-hard-way.html#cb848-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb848-9"><a href="upgma-the-hard-way.html#cb848-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind into a matrix</span></span>
<span id="cb848-10"><a href="upgma-the-hard-way.html#cb848-10" aria-hidden="true" tabindex="-1"></a>dmat1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(a,b,c,d,e)</span></code></pre></div>
<p>rbind() takes each vector (a through e) and glues them together into a matrix</p>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="upgma-the-hard-way.html#cb849-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is</span>(dmat1)</span></code></pre></div>
<pre><code>## [1] &quot;matrix&quot;           &quot;array&quot;            &quot;mMatrix&quot;          &quot;structure&quot;       
## [5] &quot;vector&quot;           &quot;vector_OR_Vector&quot; &quot;vector_OR_factor&quot;</code></pre>
<p>As a challenge, can you take these data and make these data into a matrix using the matrix() function?</p>
<p>The finished matrix looks like this</p>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb851-1"><a href="upgma-the-hard-way.html#cb851-1" aria-hidden="true" tabindex="-1"></a>dmat1</span></code></pre></div>
<pre><code>##   [,1] [,2] [,3] [,4] [,5]
## a    0   17   21   31   23
## b   17    0   30   34   21
## c   21   30    0   28   39
## d   31   34   28    0   43
## e   23   21   39   43    0</code></pre>
<p>Add names using colnames()</p>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="upgma-the-hard-way.html#cb853-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dmat1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)</span></code></pre></div>
<p>The matrix is <strong>symmetrical</strong>.</p>
<p><strong>Challenge questions:</strong> How would we interpret the diagonal? Why is it not 1? Why is this matrix symmetrical?</p>
<p>Its easier if you make redundant elements NA because we don’t need them.</p>
<p>We can access the <strong>diagonal</strong> of the matrix directly and set it to NA using the diag() function</p>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb854-1"><a href="upgma-the-hard-way.html#cb854-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(dmat1) <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>Now the matrix looks like this</p>
<div class="sourceCode" id="cb855"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb855-1"><a href="upgma-the-hard-way.html#cb855-1" aria-hidden="true" tabindex="-1"></a>dmat1</span></code></pre></div>
<pre><code>##    a  b  c  d  e
## a NA 17 21 31 23
## b 17 NA 30 34 21
## c 21 30 NA 28 39
## d 31 34 28 NA 43
## e 23 21 39 43 NA</code></pre>
<p>We only need the lower left-hand part of the matrix. We can set the upper right-hand part of the matrix to NA like this:</p>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="upgma-the-hard-way.html#cb857-1" aria-hidden="true" tabindex="-1"></a>dmat1[<span class="fu">upper.tri</span>(dmat1)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>(don’t worry about exactly what’s going on here)</p>
<p>Matrix now looks like this</p>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="upgma-the-hard-way.html#cb858-1" aria-hidden="true" tabindex="-1"></a>dmat1</span></code></pre></div>
<pre><code>##    a  b  c  d  e
## a NA NA NA NA NA
## b 17 NA NA NA NA
## c 21 30 NA NA NA
## d 31 34 28 NA NA
## e 23 21 39 43 NA</code></pre>
</div>
</div>
<div id="what-does-this-distance-matrix-represent" class="section level2" number="40.4">
<h2><span class="header-section-number">40.4</span> What does this distance matrix represent?</h2>
<div id="genetic-distances-conceptualized-as-pairwise-linear-distances" class="section level3" number="40.4.1">
<h3><span class="header-section-number">40.4.1</span> Genetic distances conceptualized as pairwise linear distances</h3>
<ul>
<li>Each element of the matrix is a <strong>pairwise distance.</strong><br />
</li>
<li>These distances were computed using <strong>pairwise alignments</strong> of each sequence.</li>
<li>In this case, it is the number of nucleotides that are different between two sequences.</li>
<li>As is standard, these alginments ignored any <strong>indels.</strong></li>
<li>There are 5 sequences, and if each is compared against the other then there are 10 total <strong>distances.</strong><br />
</li>
<li>Mathematically these are called <strong>Hamming distances</strong>.</li>
</ul>
<p>Each distance is the distance between two species, and it can be conceptualized on its own as a linear distance.</p>
<p>You could visualize a single <strong>pairwise distance</strong> like a linear distance like this:</p>
<p>(note: you don’t need to understand all of this code, but you do need to understand how it relates to the distance amtrix)</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="upgma-the-hard-way.html#cb860-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb860-2"><a href="upgma-the-hard-way.html#cb860-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(dmat1,<span class="at">na.rm =</span> T)), </span>
<span id="cb860-3"><a href="upgma-the-hard-way.html#cb860-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>), </span>
<span id="cb860-4"><a href="upgma-the-hard-way.html#cb860-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb860-5"><a href="upgma-the-hard-way.html#cb860-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">c</span>(<span class="st">&quot;Distance (number of mutations)&quot;</span>),</span>
<span id="cb860-6"><a href="upgma-the-hard-way.html#cb860-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Pairwise comparison&quot;</span>,</span>
<span id="cb860-7"><a href="upgma-the-hard-way.html#cb860-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Linear distance a vs. b&quot;</span>)</span>
<span id="cb860-8"><a href="upgma-the-hard-way.html#cb860-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">pch =</span> <span class="st">&quot;a&quot;</span>)</span>
<span id="cb860-9"><a href="upgma-the-hard-way.html#cb860-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dmat1[<span class="dv">2</span>,<span class="dv">1</span>], <span class="dv">1</span>, <span class="at">pch =</span> <span class="st">&quot;b&quot;</span>)</span>
<span id="cb860-10"><a href="upgma-the-hard-way.html#cb860-10" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">y0 =</span> <span class="dv">1</span>, </span>
<span id="cb860-11"><a href="upgma-the-hard-way.html#cb860-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">x1 =</span> dmat1[<span class="dv">2</span>,<span class="dv">1</span>],<span class="at">y1 =</span> <span class="dv">1</span>)</span>
<span id="cb860-12"><a href="upgma-the-hard-way.html#cb860-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-575-1.png" width="672" /></p>
<p>We can look at all of the distance Note that each line is <em>independent</em> and cannot be compared (the y axis has no meaning). This is NOT a 2D map!</p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="upgma-the-hard-way.html#cb861-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This code is complex and the goal is to assess the plot, not understand the code</span></span>
<span id="cb861-2"><a href="upgma-the-hard-way.html#cb861-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(dmat1,<span class="at">na.rm =</span> T)), </span>
<span id="cb861-3"><a href="upgma-the-hard-way.html#cb861-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>), </span>
<span id="cb861-4"><a href="upgma-the-hard-way.html#cb861-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb861-5"><a href="upgma-the-hard-way.html#cb861-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">c</span>(<span class="st">&quot;Distance (number of mutations)&quot;</span>),</span>
<span id="cb861-6"><a href="upgma-the-hard-way.html#cb861-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Pairwise comparison&quot;</span>)</span>
<span id="cb861-7"><a href="upgma-the-hard-way.html#cb861-7" aria-hidden="true" tabindex="-1"></a>pair.k <span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb861-8"><a href="upgma-the-hard-way.html#cb861-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dmat1)){</span>
<span id="cb861-9"><a href="upgma-the-hard-way.html#cb861-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dmat1)){</span>
<span id="cb861-10"><a href="upgma-the-hard-way.html#cb861-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb861-11"><a href="upgma-the-hard-way.html#cb861-11" aria-hidden="true" tabindex="-1"></a>dist.ij <span class="ot">&lt;-</span> dmat1[i,j] </span>
<span id="cb861-12"><a href="upgma-the-hard-way.html#cb861-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is.na</span>(dist.ij) <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb861-13"><a href="upgma-the-hard-way.html#cb861-13" aria-hidden="true" tabindex="-1"></a>  pair.k <span class="ot">&lt;-</span> pair.k<span class="sc">+</span><span class="dv">1</span>    </span>
<span id="cb861-14"><a href="upgma-the-hard-way.html#cb861-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb861-15"><a href="upgma-the-hard-way.html#cb861-15" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb861-16"><a href="upgma-the-hard-way.html#cb861-16" aria-hidden="true" tabindex="-1"></a>spp.i <span class="ot">&lt;-</span> <span class="fu">rownames</span>(dmat1)[i]</span>
<span id="cb861-17"><a href="upgma-the-hard-way.html#cb861-17" aria-hidden="true" tabindex="-1"></a>spp.j <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dmat1)[j]</span>
<span id="cb861-18"><a href="upgma-the-hard-way.html#cb861-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="sc">-</span><span class="fl">0.5</span>,               pair.k, <span class="at">pch =</span> spp.j, <span class="at">col =</span> <span class="fu">which</span>(LETTERS <span class="sc">%in%</span> <span class="fu">toupper</span>(spp.j)), <span class="at">cex =</span> <span class="fl">1.75</span>)</span>
<span id="cb861-19"><a href="upgma-the-hard-way.html#cb861-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dist.ij<span class="fl">+0.75</span>,       pair.k, <span class="at">pch =</span>spp.i, <span class="at">col =</span> <span class="fu">which</span>(LETTERS <span class="sc">%in%</span> <span class="fu">toupper</span>(spp.i)), <span class="at">cex =</span> <span class="fl">1.75</span>)</span>
<span id="cb861-20"><a href="upgma-the-hard-way.html#cb861-20" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">y0 =</span> pair.k, </span>
<span id="cb861-21"><a href="upgma-the-hard-way.html#cb861-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">x1 =</span> dist.ij, <span class="at">y1 =</span> pair.k)</span>
<span id="cb861-22"><a href="upgma-the-hard-way.html#cb861-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> pair.k<span class="fl">+0.5</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb861-23"><a href="upgma-the-hard-way.html#cb861-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb861-24"><a href="upgma-the-hard-way.html#cb861-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb861-25"><a href="upgma-the-hard-way.html#cb861-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb861-26"><a href="upgma-the-hard-way.html#cb861-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-576-1.png" width="672" /></p>
<ul>
<li>We can see that the distance between a and b is the smallest, at 17 amino acid changes.</li>
<li>UPGMA, WPGMA and related algorithms all begin by identifying the two taxa that are closest together.</li>
<li>These 2 taxa form a clade (cluster). THe algorithm then proceeds by finding the next taxa (eg, c, d or e) which is closest to that clade of a and b</li>
<li>We can summarize this first clad using <strong>Newick notation</strong> as: (a, b)</li>
</ul>
</div>
<div id="genetic-distances-conceptualized-as-2d-map-of-linear-distances" class="section level3" number="40.4.2">
<h3><span class="header-section-number">40.4.2</span> Genetic distances conceptualized as 2D map of linear distances</h3>
<ul>
<li>We can extend the analogy of linear distance to two dimensions.<br />
</li>
<li>With some fancy math we can make a 2D plot where the distances in 2D space are <em>similar</em> to the distances in the matrix.<br />
</li>
<li>This is NOT exact and should not be taken literally. (See Pevsner Chapter 7 for a similar use of a 2D map)</li>
<li>This is just a tool for teaching and not something done as part of an actual analysis.</li>
</ul>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="upgma-the-hard-way.html#cb862-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb862-2"><a href="upgma-the-hard-way.html#cb862-2" aria-hidden="true" tabindex="-1"></a>dmat1no0 <span class="ot">&lt;-</span> dmat1</span>
<span id="cb862-3"><a href="upgma-the-hard-way.html#cb862-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb862-4"><a href="upgma-the-hard-way.html#cb862-4" aria-hidden="true" tabindex="-1"></a>dmat1no0[<span class="fu">is.na</span>(dmat1no0)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb862-5"><a href="upgma-the-hard-way.html#cb862-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb862-6"><a href="upgma-the-hard-way.html#cb862-6" aria-hidden="true" tabindex="-1"></a>d2  <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(dmat1no0, <span class="at">add =</span>T)</span>
<span id="cb862-7"><a href="upgma-the-hard-way.html#cb862-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> d2<span class="sc">$</span>points[,<span class="dv">1</span>]</span>
<span id="cb862-8"><a href="upgma-the-hard-way.html#cb862-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> d2<span class="sc">$</span>points[,<span class="dv">2</span>]</span>
<span id="cb862-9"><a href="upgma-the-hard-way.html#cb862-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y, <span class="at">main =</span> <span class="st">&quot;APPROXIMATE 2D distances&quot;</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb862-10"><a href="upgma-the-hard-way.html#cb862-10" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(x, y, <span class="at">labels =</span> <span class="fu">row.names</span>(d2<span class="sc">$</span>points), <span class="at">cex=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-577-1.png" width="672" /></p>
<ul>
<li>In this plot, things appear to have been distorted a bit.</li>
<li>a and b are close to each other as expect,</li>
<li>but b looks closest than e (to me).<br />
</li>
<li>It does show how a and b are close, and d and e are further apart.</li>
</ul>
</div>
</div>
<div id="from-linear-distances-to-tree-distances" class="section level2" number="40.5">
<h2><span class="header-section-number">40.5</span> From linear distances to “tree distances”</h2>
<p><strong>Genetic distances</strong> aren’t actually linear - we are assuming a “tree shape” to represent the divergence of two species genetically (and possibly geographically).</p>
<p>The simplest methods of building trees assume that all branch lengths terminate at the same distance from the root, and the total mutational distance traversed by each species is the same. (This is the assumption or constraint related to <strong>ultrametricity</strong>).</p>
<p>The distance between a and b is 17. We assume that both species a and species b have undergone the same number of mutations since they split, so the branch lengths for each are 17/2 = 8.5. (You obviously can’t have 8.5 mutations, but this is how the math works).</p>
<p>The following plots shows how the linear distnace of 17 between a and b (bottom) gets split into two branches, each of 8.5.</p>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="upgma-the-hard-way.html#cb863-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This code is dense; run it and focus on the plot</span></span>
<span id="cb863-2"><a href="upgma-the-hard-way.html#cb863-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb863-3"><a href="upgma-the-hard-way.html#cb863-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(dmat1,<span class="at">na.rm =</span> T)), </span>
<span id="cb863-4"><a href="upgma-the-hard-way.html#cb863-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>), </span>
<span id="cb863-5"><a href="upgma-the-hard-way.html#cb863-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb863-6"><a href="upgma-the-hard-way.html#cb863-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">c</span>(<span class="st">&quot;Distance (number of mutations)&quot;</span>),</span>
<span id="cb863-7"><a href="upgma-the-hard-way.html#cb863-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Pairwise comparison&quot;</span>)</span>
<span id="cb863-8"><a href="upgma-the-hard-way.html#cb863-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">pch =</span> <span class="st">&quot;a&quot;</span>)</span>
<span id="cb863-9"><a href="upgma-the-hard-way.html#cb863-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dmat1[<span class="dv">2</span>,<span class="dv">1</span>], <span class="dv">1</span>, <span class="at">pch =</span> <span class="st">&quot;b&quot;</span>)</span>
<span id="cb863-10"><a href="upgma-the-hard-way.html#cb863-10" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">y0 =</span> <span class="dv">1</span>, </span>
<span id="cb863-11"><a href="upgma-the-hard-way.html#cb863-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">x1 =</span> dmat1[<span class="dv">2</span>,<span class="dv">1</span>],<span class="at">y1 =</span> <span class="dv">1</span>)</span>
<span id="cb863-12"><a href="upgma-the-hard-way.html#cb863-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb863-13"><a href="upgma-the-hard-way.html#cb863-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb863-14"><a href="upgma-the-hard-way.html#cb863-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb863-15"><a href="upgma-the-hard-way.html#cb863-15" aria-hidden="true" tabindex="-1"></a>branch.length <span class="ot">&lt;-</span> dmat1[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb863-16"><a href="upgma-the-hard-way.html#cb863-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb863-17"><a href="upgma-the-hard-way.html#cb863-17" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(branch.length<span class="fl">+0.75</span>, <span class="dv">4</span>, <span class="at">pch =</span> <span class="st">&quot;a&quot;</span>)</span>
<span id="cb863-18"><a href="upgma-the-hard-way.html#cb863-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">0</span>, <span class="dv">6</span>)</span>
<span id="cb863-19"><a href="upgma-the-hard-way.html#cb863-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(branch.length<span class="fl">+0.75</span>, <span class="dv">6</span>, <span class="at">pch =</span> <span class="st">&quot;b&quot;</span>)</span>
<span id="cb863-20"><a href="upgma-the-hard-way.html#cb863-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb863-21"><a href="upgma-the-hard-way.html#cb863-21" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">y0 =</span> <span class="dv">4</span>, </span>
<span id="cb863-22"><a href="upgma-the-hard-way.html#cb863-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">x1 =</span> branch.length,<span class="at">y1 =</span> <span class="dv">4</span>)</span>
<span id="cb863-23"><a href="upgma-the-hard-way.html#cb863-23" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">y0 =</span> <span class="dv">6</span>, </span>
<span id="cb863-24"><a href="upgma-the-hard-way.html#cb863-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">x1 =</span> branch.length,<span class="at">y1 =</span> <span class="dv">6</span>)</span>
<span id="cb863-25"><a href="upgma-the-hard-way.html#cb863-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb863-26"><a href="upgma-the-hard-way.html#cb863-26" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">y0 =</span> <span class="dv">4</span>, </span>
<span id="cb863-27"><a href="upgma-the-hard-way.html#cb863-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">x1 =</span> <span class="dv">0</span>, <span class="at">y1 =</span> <span class="dv">6</span>, <span class="at">col =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb863-28"><a href="upgma-the-hard-way.html#cb863-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb863-29"><a href="upgma-the-hard-way.html#cb863-29" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">8</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-578-1.png" width="672" /></p>
<p>Again, in <strong>Newick notation</strong>, we’d write (a, b) to indicate that a and b are a clade.</p>
</div>
<div id="the-upgma-algorithm" class="section level2" number="40.6">
<h2><span class="header-section-number">40.6</span> The UPGMA algorithm</h2>
<p><em>The UPGMA algorithm is described by Swofford et al (1996?, page 486) as below.<br />
</em> The word “cluster” means “taxa” in some cases and “clade” in others.<br />
* This is a bit tricky at first but once you get a sense for the whole algorithm it will make more sense.
* To keep track of everything we’ll use subscripts i and j, represented in plain text as e.g. d.ij for the distance (d) in row i and column j.</p>
<div id="step-1-find-the-2-taxa-that-are-currently-closest-together" class="section level3" number="40.6.1">
<h3><span class="header-section-number">40.6.1</span> Step 1: find the 2 taxa that are currently closest together</h3>
<ol style="list-style-type: decimal">
<li>“Given a matrix of <strong>pairwise distances</strong>, find the clusters (taxa) i and j such the d.ij is the minmum value in the table.” (d.ij is the distance between taxa i and taxa j)</li>
</ol>
<p>In our example, d.ij = d.ba = 17, with i = b and j = a.</p>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="upgma-the-hard-way.html#cb864-1" aria-hidden="true" tabindex="-1"></a>dmat1[<span class="st">&quot;b&quot;</span>,<span class="st">&quot;a&quot;</span>]</span></code></pre></div>
<pre><code>## [1] 17</code></pre>
</div>
<div id="step-2-calculate-the-branch-lengths-connect-the-taxa-to-their-shared-node" class="section level3" number="40.6.2">
<h3><span class="header-section-number">40.6.2</span> Step 2: calculate the branch lengths connect the taxa to their shared node</h3>
<ol start="2" style="list-style-type: decimal">
<li>“Define the depth of the branching between i and j (l.ij) to be d.ij/2” (“depth of branching” = <strong>branch length</strong>; so i is attached to a branch of d.ij/2 and j is attached to a separate branch of d.ij/2)</li>
</ol>
<p>d.ab/2 = 8.5</p>
</div>
<div id="step-3a-determine-if-the-algorithm-is-done" class="section level3" number="40.6.3">
<h3><span class="header-section-number">40.6.3</span> Step 3a: determine if the algorithm is done</h3>
<ol start="3" style="list-style-type: decimal">
<li>“If i and j were the last two clusters, the tree is complete”</li>
</ol>
</div>
<div id="step-3a-continue-on-if-needed-and-combine-the-previous-cluster-into-cluster-u" class="section level3" number="40.6.4">
<h3><span class="header-section-number">40.6.4</span> Step 3a: Continue on if needed and combine the previous cluster into cluster “u”</h3>
<ol start="3" style="list-style-type: decimal">
<li>If there is more to do, “create a new cluster called u.” This new cluster is a clade of a and b will represent the combined features of a and b.</li>
</ol>
<p>What this means is that now that we’ve mapped taxa a and b into a clade we need to update our matrix to determine how far all the remaining taca (c, d and e) are from that clade.</p>
</div>
<div id="step-4-determine-the-distance-from-u-to-the-other-remaining-clusters." class="section level3" number="40.6.5">
<h3><span class="header-section-number">40.6.5</span> Step 4: Determine the distance from u to the other remaining clusters.</h3>
<ol start="4" style="list-style-type: decimal">
<li>“Define the distance from [the new cluster] u to each other [remaining] cluster (k, with k==i or j) [here cluster = clade in the first part of the sentence and taxa in the other] to be an <strong>average</strong> of the distnace d.ki and d.jk.” That is, calculate the distance from the new clade u to all the remaining taxa, which we’ll generically call “k.” The new distance will be called d.ku, for “distance from taxa k to clade u.”</li>
</ol>
<p>The exact calculation of the average can take different forms. This will be unpacked below.</p>
</div>
<div id="step-5-create-a-new-matrix" class="section level3" number="40.6.6">
<h3><span class="header-section-number">40.6.6</span> Step 5: Create a new matrix</h3>
<ol start="5" style="list-style-type: decimal">
<li>“Go back to step 1 with one less cluster; cluster i and j have been eliminated, and cluster u has been added.” The distance matrix is now shrunk with all distance related to i and j removed and replaced by information about u.</li>
</ol>
</div>
<div id="key-step-calculating-the-distance-from-a-clade-to-the-remaining-taxa" class="section level3" number="40.6.7">
<h3><span class="header-section-number">40.6.7</span> Key step: calculating the distance from a clade to the remaining taxa</h3>
<p>For step 4, UPGMA uses the equation below to calculate distances. This will require some notation:</p>
<ul>
<li>Ti = the number of taxa in cluster i. This is 1 if the “cluster” is a single taxa (eg. 1 species), or it can be &gt;1 if a previous iteration has created a clade.<br />
</li>
<li>Tj = the number of taxa in cluster j.</li>
<li>d.ku = the distance from k to u. k and u can be individual taxa OR clades created by the algorithm.</li>
</ul>
<p>The key quantity d.ku is calculated as:</p>
<p>d.ku = (Ti x d.ki + Tj x d.kj)/(Ti + Tj)</p>
<p>(You should know this equation AND you should be able to write R code to calcualte it)</p>
<p>You can think of this as a <strong>weighted mean</strong> where the <strong>weights</strong> are the number of taxa in each clade. Its a very annoying that the “U” in UPGMA means “un-weighted” even though there is, from one perspective weighting, but this is how the math people say we should think about it (the un-weighted part has to do with some other aspect of the math).</p>
<p>In the above outline of the algorithm, if i and j are the first two taxa grouped then the equation would be</p>
<p>d.ku = (Ti x d.ki + Tj x d.kj)/(Ti + Tj)
Ti = 1, Tj = 1, so
d.ku = (1 x d.ki + 1 x d.kj)/(1 + 1)
d.ku = (d.ki + d.kj)/2</p>
</div>
</div>
<div id="calculate-2d-representation" class="section level2" number="40.7">
<h2><span class="header-section-number">40.7</span> Calculate 2D representation</h2>
<p>We can think about this using a 2D representation.</p>
<p>First, plot the 2D map.</p>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="upgma-the-hard-way.html#cb866-1" aria-hidden="true" tabindex="-1"></a>dmat1.out<span class="ot">&lt;-</span> <span class="fu">plot_dist_as_nmds</span>(dmat1)</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-580-1.png" width="672" /></p>
<p>a and b are closest together, so we group them</p>
<p>I’ll show this in the code below; you don’t need to understand exactly how this code works.</p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="upgma-the-hard-way.html#cb867-1" aria-hidden="true" tabindex="-1"></a>dmat1.out<span class="ot">&lt;-</span> <span class="fu">plot_dist_as_nmds</span>(dmat1)</span>
<span id="cb867-2"><a href="upgma-the-hard-way.html#cb867-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb867-3"><a href="upgma-the-hard-way.html#cb867-3" aria-hidden="true" tabindex="-1"></a><span class="co">#get x y coord of a and b</span></span>
<span id="cb867-4"><a href="upgma-the-hard-way.html#cb867-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb867-5"><a href="upgma-the-hard-way.html#cb867-5" aria-hidden="true" tabindex="-1"></a>a.<span class="ot">&lt;-</span>dmat1.out<span class="sc">$</span>points[<span class="st">&quot;a&quot;</span>,]</span>
<span id="cb867-6"><a href="upgma-the-hard-way.html#cb867-6" aria-hidden="true" tabindex="-1"></a>b.<span class="ot">&lt;-</span>dmat1.out<span class="sc">$</span>points[<span class="st">&quot;b&quot;</span>,]</span>
<span id="cb867-7"><a href="upgma-the-hard-way.html#cb867-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb867-8"><a href="upgma-the-hard-way.html#cb867-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_dist_as_nmds</span>(dmat1)</span></code></pre></div>
<pre><code>## $points
##         [,1]       [,2]
## a   6.606653  4.9400937
## b  12.421702 -6.5267890
## c  -9.532025 12.9665271
## d -17.839642 -9.0739515
## e  20.738283  0.4897976
## 
## $eig
## NULL
## 
## $x
## NULL
## 
## $ac
## [1] -7.934712e-15
## 
## $GOF
## [1] 0.6755273 0.9367305</code></pre>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="upgma-the-hard-way.html#cb869-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.ellipse</span>(<span class="at">x =</span> <span class="fu">mean</span>(<span class="fu">c</span>(a.[<span class="dv">1</span>],b.[<span class="dv">1</span>])), </span>
<span id="cb869-2"><a href="upgma-the-hard-way.html#cb869-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fu">mean</span>(<span class="fu">c</span>(a.[<span class="dv">2</span>],b.[<span class="dv">2</span>])),</span>
<span id="cb869-3"><a href="upgma-the-hard-way.html#cb869-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">a =</span><span class="dv">3</span>, </span>
<span id="cb869-4"><a href="upgma-the-hard-way.html#cb869-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">b =</span> <span class="dv">10</span>, </span>
<span id="cb869-5"><a href="upgma-the-hard-way.html#cb869-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">angle =</span> <span class="dv">30</span></span>
<span id="cb869-6"><a href="upgma-the-hard-way.html#cb869-6" aria-hidden="true" tabindex="-1"></a>             )</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-581-1.png" width="672" /></p>
<p>Once we have created a cluster (clade) we can consider the distance from the members of clade to all the remaining points. For example, here’s the distnace from a and b to c</p>
<div class="sourceCode" id="cb870"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb870-1"><a href="upgma-the-hard-way.html#cb870-1" aria-hidden="true" tabindex="-1"></a><span class="co"># distance from ab to c</span></span>
<span id="cb870-2"><a href="upgma-the-hard-way.html#cb870-2" aria-hidden="true" tabindex="-1"></a>c.<span class="ot">&lt;-</span>dmat1.out<span class="sc">$</span>points[<span class="st">&quot;c&quot;</span>,]</span>
<span id="cb870-3"><a href="upgma-the-hard-way.html#cb870-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb870-4"><a href="upgma-the-hard-way.html#cb870-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_dist_as_nmds</span>(dmat1)</span></code></pre></div>
<pre><code>## $points
##         [,1]       [,2]
## a   6.606653  4.9400937
## b  12.421702 -6.5267890
## c  -9.532025 12.9665271
## d -17.839642 -9.0739515
## e  20.738283  0.4897976
## 
## $eig
## NULL
## 
## $x
## NULL
## 
## $ac
## [1] -7.934712e-15
## 
## $GOF
## [1] 0.6755273 0.9367305</code></pre>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb872-1"><a href="upgma-the-hard-way.html#cb872-1" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> a.[<span class="dv">1</span>],<span class="at">x1 =</span> c.[<span class="dv">1</span>],</span>
<span id="cb872-2"><a href="upgma-the-hard-way.html#cb872-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">y0 =</span> a.[<span class="dv">2</span>],<span class="at">y1 =</span> c.[<span class="dv">2</span>])</span>
<span id="cb872-3"><a href="upgma-the-hard-way.html#cb872-3" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> b.[<span class="dv">1</span>],<span class="at">x1 =</span> c.[<span class="dv">1</span>],</span>
<span id="cb872-4"><a href="upgma-the-hard-way.html#cb872-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y0 =</span> b.[<span class="dv">2</span>],<span class="at">y1 =</span> c.[<span class="dv">2</span>])                                    </span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-582-1.png" width="672" /></p>
<p>In UPGMA, we first define a clade. We then need to see which taxa is closest to that clade. Visually it looks like this</p>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="upgma-the-hard-way.html#cb873-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb873-2"><a href="upgma-the-hard-way.html#cb873-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-3"><a href="upgma-the-hard-way.html#cb873-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ab to c</span></span>
<span id="cb873-4"><a href="upgma-the-hard-way.html#cb873-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_dist_as_nmds</span>(dmat1)</span></code></pre></div>
<pre><code>## $points
##         [,1]       [,2]
## a   6.606653  4.9400937
## b  12.421702 -6.5267890
## c  -9.532025 12.9665271
## d -17.839642 -9.0739515
## e  20.738283  0.4897976
## 
## $eig
## NULL
## 
## $x
## NULL
## 
## $ac
## [1] -7.934712e-15
## 
## $GOF
## [1] 0.6755273 0.9367305</code></pre>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb875-1"><a href="upgma-the-hard-way.html#cb875-1" aria-hidden="true" tabindex="-1"></a><span class="co">#get x y coord of a and b</span></span>
<span id="cb875-2"><a href="upgma-the-hard-way.html#cb875-2" aria-hidden="true" tabindex="-1"></a>a.<span class="ot">&lt;-</span>dmat1.out<span class="sc">$</span>points[<span class="st">&quot;a&quot;</span>,]</span>
<span id="cb875-3"><a href="upgma-the-hard-way.html#cb875-3" aria-hidden="true" tabindex="-1"></a>b.<span class="ot">&lt;-</span>dmat1.out<span class="sc">$</span>points[<span class="st">&quot;b&quot;</span>,]</span>
<span id="cb875-4"><a href="upgma-the-hard-way.html#cb875-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb875-5"><a href="upgma-the-hard-way.html#cb875-5" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.ellipse</span>(<span class="at">x =</span> <span class="fu">mean</span>(<span class="fu">c</span>(a.[<span class="dv">1</span>],b.[<span class="dv">1</span>])), </span>
<span id="cb875-6"><a href="upgma-the-hard-way.html#cb875-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fu">mean</span>(<span class="fu">c</span>(a.[<span class="dv">2</span>],b.[<span class="dv">2</span>])),</span>
<span id="cb875-7"><a href="upgma-the-hard-way.html#cb875-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">a =</span><span class="dv">3</span>, </span>
<span id="cb875-8"><a href="upgma-the-hard-way.html#cb875-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">b =</span> <span class="dv">10</span>, </span>
<span id="cb875-9"><a href="upgma-the-hard-way.html#cb875-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">angle =</span> <span class="dv">30</span>)</span>
<span id="cb875-10"><a href="upgma-the-hard-way.html#cb875-10" aria-hidden="true" tabindex="-1"></a>c.<span class="ot">&lt;-</span>d2<span class="sc">$</span>points[<span class="st">&quot;c&quot;</span>,]</span>
<span id="cb875-11"><a href="upgma-the-hard-way.html#cb875-11" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> a.[<span class="dv">1</span>],<span class="at">x1 =</span> c.[<span class="dv">1</span>],</span>
<span id="cb875-12"><a href="upgma-the-hard-way.html#cb875-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">y0 =</span> a.[<span class="dv">2</span>],<span class="at">y1 =</span> c.[<span class="dv">2</span>])</span>
<span id="cb875-13"><a href="upgma-the-hard-way.html#cb875-13" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> b.[<span class="dv">1</span>],<span class="at">x1 =</span> c.[<span class="dv">1</span>],</span>
<span id="cb875-14"><a href="upgma-the-hard-way.html#cb875-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">y0 =</span> b.[<span class="dv">2</span>],<span class="at">y1 =</span> c.[<span class="dv">2</span>])  </span>
<span id="cb875-15"><a href="upgma-the-hard-way.html#cb875-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb875-16"><a href="upgma-the-hard-way.html#cb875-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ab to d</span></span>
<span id="cb875-17"><a href="upgma-the-hard-way.html#cb875-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_dist_as_nmds</span>(dmat1)</span></code></pre></div>
<pre><code>## $points
##         [,1]       [,2]
## a   6.606653  4.9400937
## b  12.421702 -6.5267890
## c  -9.532025 12.9665271
## d -17.839642 -9.0739515
## e  20.738283  0.4897976
## 
## $eig
## NULL
## 
## $x
## NULL
## 
## $ac
## [1] -7.934712e-15
## 
## $GOF
## [1] 0.6755273 0.9367305</code></pre>
<div class="sourceCode" id="cb877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb877-1"><a href="upgma-the-hard-way.html#cb877-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.ellipse</span>(<span class="at">x =</span> <span class="fu">mean</span>(<span class="fu">c</span>(a.[<span class="dv">1</span>],b.[<span class="dv">1</span>])), </span>
<span id="cb877-2"><a href="upgma-the-hard-way.html#cb877-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fu">mean</span>(<span class="fu">c</span>(a.[<span class="dv">2</span>],b.[<span class="dv">2</span>])),</span>
<span id="cb877-3"><a href="upgma-the-hard-way.html#cb877-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">a =</span><span class="dv">3</span>, </span>
<span id="cb877-4"><a href="upgma-the-hard-way.html#cb877-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">b =</span> <span class="dv">10</span>, </span>
<span id="cb877-5"><a href="upgma-the-hard-way.html#cb877-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">angle =</span> <span class="dv">30</span>)</span>
<span id="cb877-6"><a href="upgma-the-hard-way.html#cb877-6" aria-hidden="true" tabindex="-1"></a>d.<span class="ot">&lt;-</span>d2<span class="sc">$</span>points[<span class="st">&quot;d&quot;</span>,]</span>
<span id="cb877-7"><a href="upgma-the-hard-way.html#cb877-7" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> a.[<span class="dv">1</span>],<span class="at">x1 =</span> d.[<span class="dv">1</span>],</span>
<span id="cb877-8"><a href="upgma-the-hard-way.html#cb877-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">y0 =</span> a.[<span class="dv">2</span>],<span class="at">y1 =</span> d.[<span class="dv">2</span>])</span>
<span id="cb877-9"><a href="upgma-the-hard-way.html#cb877-9" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> b.[<span class="dv">1</span>],<span class="at">x1 =</span> d.[<span class="dv">1</span>],</span>
<span id="cb877-10"><a href="upgma-the-hard-way.html#cb877-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">y0 =</span> b.[<span class="dv">2</span>],<span class="at">y1 =</span> d.[<span class="dv">2</span>])  </span>
<span id="cb877-11"><a href="upgma-the-hard-way.html#cb877-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb877-12"><a href="upgma-the-hard-way.html#cb877-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ab to e</span></span>
<span id="cb877-13"><a href="upgma-the-hard-way.html#cb877-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_dist_as_nmds</span>(dmat1)</span></code></pre></div>
<pre><code>## $points
##         [,1]       [,2]
## a   6.606653  4.9400937
## b  12.421702 -6.5267890
## c  -9.532025 12.9665271
## d -17.839642 -9.0739515
## e  20.738283  0.4897976
## 
## $eig
## NULL
## 
## $x
## NULL
## 
## $ac
## [1] -7.934712e-15
## 
## $GOF
## [1] 0.6755273 0.9367305</code></pre>
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb879-1"><a href="upgma-the-hard-way.html#cb879-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.ellipse</span>(<span class="at">x =</span> <span class="fu">mean</span>(<span class="fu">c</span>(a.[<span class="dv">1</span>],b.[<span class="dv">1</span>])), </span>
<span id="cb879-2"><a href="upgma-the-hard-way.html#cb879-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fu">mean</span>(<span class="fu">c</span>(a.[<span class="dv">2</span>],b.[<span class="dv">2</span>])),</span>
<span id="cb879-3"><a href="upgma-the-hard-way.html#cb879-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">a =</span><span class="dv">3</span>, </span>
<span id="cb879-4"><a href="upgma-the-hard-way.html#cb879-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">b =</span> <span class="dv">10</span>, </span>
<span id="cb879-5"><a href="upgma-the-hard-way.html#cb879-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">angle =</span> <span class="dv">30</span>)</span>
<span id="cb879-6"><a href="upgma-the-hard-way.html#cb879-6" aria-hidden="true" tabindex="-1"></a>e.<span class="ot">&lt;-</span>d2<span class="sc">$</span>points[<span class="st">&quot;e&quot;</span>,]</span>
<span id="cb879-7"><a href="upgma-the-hard-way.html#cb879-7" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> a.[<span class="dv">1</span>],<span class="at">x1 =</span> e.[<span class="dv">1</span>],</span>
<span id="cb879-8"><a href="upgma-the-hard-way.html#cb879-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">y0 =</span> a.[<span class="dv">2</span>],<span class="at">y1 =</span> e.[<span class="dv">2</span>])</span>
<span id="cb879-9"><a href="upgma-the-hard-way.html#cb879-9" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> b.[<span class="dv">1</span>],<span class="at">x1 =</span> e.[<span class="dv">1</span>],</span>
<span id="cb879-10"><a href="upgma-the-hard-way.html#cb879-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">y0 =</span> b.[<span class="dv">2</span>],<span class="at">y1 =</span> e.[<span class="dv">2</span>]) </span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-583-1.png" width="672" /></p>
</div>
<div id="algorithm---round-1" class="section level2" number="40.8">
<h2><span class="header-section-number">40.8</span> Algorithm - round 1</h2>
<p>We will now implement the algorithm.</p>
<p>NOTE: I am not using a consistent system of nomeclature - I am mixing my own conventions with hose of Swofford et al. Sorry :(</p>
<p>First we’ll need a dataframe to hold tings</p>
<ul>
<li>it = iteration</li>
<li>clust.i, clust.j = the two taxa or clades being combined</li>
<li>dist.ij = value from distnace matrix between the taxa</li>
<li>clust.u = name of the new combined cluster (clade)</li>
<li>branch.l.ij = branch lengths</li>
</ul>
<p>A matrix to hold things as I work</p>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb880-1"><a href="upgma-the-hard-way.html#cb880-1" aria-hidden="true" tabindex="-1"></a>n.taxa <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dmat1)</span>
<span id="cb880-2"><a href="upgma-the-hard-way.html#cb880-2" aria-hidden="true" tabindex="-1"></a>UPGMA_output <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">it =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n.taxa),</span>
<span id="cb880-3"><a href="upgma-the-hard-way.html#cb880-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">clust.i =</span> <span class="cn">NA</span>,</span>
<span id="cb880-4"><a href="upgma-the-hard-way.html#cb880-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">clust.j =</span> <span class="cn">NA</span>,</span>
<span id="cb880-5"><a href="upgma-the-hard-way.html#cb880-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">dist.ij =</span> <span class="cn">NA</span>,</span>
<span id="cb880-6"><a href="upgma-the-hard-way.html#cb880-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">clust.u =</span> <span class="cn">NA</span>,</span>
<span id="cb880-7"><a href="upgma-the-hard-way.html#cb880-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">branch.l.ij =</span> <span class="cn">NA</span>)</span></code></pre></div>
<div id="determine-minimum-value-in-current-matrix" class="section level3" number="40.8.1">
<h3><span class="header-section-number">40.8.1</span> Determine minimum value in current matrix</h3>
<p>The minimum distance using the min() function</p>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb881-1"><a href="upgma-the-hard-way.html#cb881-1" aria-hidden="true" tabindex="-1"></a>dist.min.i <span class="ot">&lt;-</span> <span class="fu">min</span>(dmat1, <span class="at">na.rm =</span> T)</span></code></pre></div>
<p>The index value of the minimum, using which()</p>
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb882-1"><a href="upgma-the-hard-way.html#cb882-1" aria-hidden="true" tabindex="-1"></a>index.min.i <span class="ot">&lt;-</span> <span class="fu">which</span>(dmat1 <span class="sc">==</span> dist.min.i, <span class="at">arr.ind =</span>T)</span>
<span id="cb882-2"><a href="upgma-the-hard-way.html#cb882-2" aria-hidden="true" tabindex="-1"></a>index.row.i <span class="ot">&lt;-</span> index.min.i[<span class="dv">1</span>]</span>
<span id="cb882-3"><a href="upgma-the-hard-way.html#cb882-3" aria-hidden="true" tabindex="-1"></a>index.col.i <span class="ot">&lt;-</span> index.min.i[<span class="dv">2</span>]</span></code></pre></div>
<p>We can get the names of our taxa using rownames() and colnames()</p>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb883-1"><a href="upgma-the-hard-way.html#cb883-1" aria-hidden="true" tabindex="-1"></a>cluster.i2 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(dmat1)[index.row.i]</span>
<span id="cb883-2"><a href="upgma-the-hard-way.html#cb883-2" aria-hidden="true" tabindex="-1"></a>cluster.i1 <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dmat1)[index.col.i]</span></code></pre></div>
<p>Add output to dataframe</p>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="upgma-the-hard-way.html#cb884-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the clusters we&#39;re working iwth</span></span>
<span id="cb884-2"><a href="upgma-the-hard-way.html#cb884-2" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">1</span>,<span class="st">&quot;clust.i&quot;</span>] <span class="ot">&lt;-</span> cluster.i1</span>
<span id="cb884-3"><a href="upgma-the-hard-way.html#cb884-3" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">1</span>,<span class="st">&quot;clust.j&quot;</span>] <span class="ot">&lt;-</span> cluster.i2</span>
<span id="cb884-4"><a href="upgma-the-hard-way.html#cb884-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb884-5"><a href="upgma-the-hard-way.html#cb884-5" aria-hidden="true" tabindex="-1"></a><span class="co"># the distance between them</span></span>
<span id="cb884-6"><a href="upgma-the-hard-way.html#cb884-6" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">1</span>,<span class="st">&quot;dist.ij&quot;</span>] <span class="ot">&lt;-</span> dist.min.i</span></code></pre></div>
</div>
<div id="combine-species-into-clade" class="section level3" number="40.8.2">
<h3><span class="header-section-number">40.8.2</span> Combine species into clade</h3>
<p>Combine the two taxa names into a new name. This can be done a couple ways.</p>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb885-1"><a href="upgma-the-hard-way.html#cb885-1" aria-hidden="true" tabindex="-1"></a><span class="co"># name of our clade</span></span>
<span id="cb885-2"><a href="upgma-the-hard-way.html#cb885-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb885-3"><a href="upgma-the-hard-way.html#cb885-3" aria-hidden="true" tabindex="-1"></a><span class="do">## hard-code &quot;ab&quot;</span></span>
<span id="cb885-4"><a href="upgma-the-hard-way.html#cb885-4" aria-hidden="true" tabindex="-1"></a>clade.i <span class="ot">&lt;-</span> <span class="st">&quot;ab&quot;</span></span>
<span id="cb885-5"><a href="upgma-the-hard-way.html#cb885-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb885-6"><a href="upgma-the-hard-way.html#cb885-6" aria-hidden="true" tabindex="-1"></a><span class="do">## use paste() to generate name</span></span>
<span id="cb885-7"><a href="upgma-the-hard-way.html#cb885-7" aria-hidden="true" tabindex="-1"></a>clade.i <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb885-8"><a href="upgma-the-hard-way.html#cb885-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb885-9"><a href="upgma-the-hard-way.html#cb885-9" aria-hidden="true" tabindex="-1"></a><span class="do">## general, re-usable code using paste() and object names</span></span>
<span id="cb885-10"><a href="upgma-the-hard-way.html#cb885-10" aria-hidden="true" tabindex="-1"></a>clade.i <span class="ot">&lt;-</span> <span class="fu">paste</span>(cluster.i1,cluster.i2, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>We’ll add this to the dataframe</p>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="upgma-the-hard-way.html#cb886-1" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">1</span>,<span class="st">&quot;clust.u&quot;</span>] <span class="ot">&lt;-</span> clade.i</span></code></pre></div>
<p>Look at things so far</p>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="upgma-the-hard-way.html#cb887-1" aria-hidden="true" tabindex="-1"></a>UPGMA_output</span></code></pre></div>
<pre><code>##   it clust.i clust.j dist.ij clust.u branch.l.ij
## 1  1       a       b      17      ab          NA
## 2  2    &lt;NA&gt;    &lt;NA&gt;      NA    &lt;NA&gt;          NA
## 3  3    &lt;NA&gt;    &lt;NA&gt;      NA    &lt;NA&gt;          NA
## 4  4    &lt;NA&gt;    &lt;NA&gt;      NA    &lt;NA&gt;          NA
## 5  5    &lt;NA&gt;    &lt;NA&gt;      NA    &lt;NA&gt;          NA</code></pre>
</div>
<div id="calculate-branch-length" class="section level3" number="40.8.3">
<h3><span class="header-section-number">40.8.3</span> Calculate branch length</h3>
<p>Branch length is the distance between the two taxa: distance/2 or d.ij/2</p>
<p>We can access the distance in our first row of the matrix like this</p>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="upgma-the-hard-way.html#cb889-1" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">1</span>,<span class="st">&quot;dist.ij&quot;</span>]</span></code></pre></div>
<pre><code>## [1] 17</code></pre>
<p>We can divided the distance betyween a and b by 2 to get our branch length like this</p>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb891-1"><a href="upgma-the-hard-way.html#cb891-1" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">1</span>,<span class="st">&quot;dist.ij&quot;</span>]<span class="sc">/</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 8.5</code></pre>
<p>Now store the distance d in the dataframe</p>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb893-1"><a href="upgma-the-hard-way.html#cb893-1" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">1</span>,<span class="st">&quot;branch.l.ij&quot;</span>] <span class="ot">&lt;-</span> UPGMA_output[<span class="dv">1</span>,<span class="st">&quot;dist.ij&quot;</span>]<span class="sc">/</span><span class="dv">2</span></span></code></pre></div>
<p>We’ve now completed our first round of calculations</p>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="upgma-the-hard-way.html#cb894-1" aria-hidden="true" tabindex="-1"></a>UPGMA_output</span></code></pre></div>
<pre><code>##   it clust.i clust.j dist.ij clust.u branch.l.ij
## 1  1       a       b      17      ab         8.5
## 2  2    &lt;NA&gt;    &lt;NA&gt;      NA    &lt;NA&gt;          NA
## 3  3    &lt;NA&gt;    &lt;NA&gt;      NA    &lt;NA&gt;          NA
## 4  4    &lt;NA&gt;    &lt;NA&gt;      NA    &lt;NA&gt;          NA
## 5  5    &lt;NA&gt;    &lt;NA&gt;      NA    &lt;NA&gt;          NA</code></pre>
</div>
<div id="calculate-distance-from-clade-to-all-other-points" class="section level3" number="40.8.4">
<h3><span class="header-section-number">40.8.4</span> Calculate distance from clade to all other points</h3>
<p>Distance (ab) to all other points</p>
<ul>
<li>ab to c</li>
<li>ab to d</li>
<li>ab to e</li>
</ul>
<div id="ab-to-c" class="section level4" number="40.8.4.1">
<h4><span class="header-section-number">40.8.4.1</span> ab to c</h4>
<p>This is calculated at the average of the distance</p>
<ul>
<li>from a to c, and</li>
<li>from b to c.</li>
</ul>
<p>In the Wikipedia article the math is framed like this</p>
<p>D(ab to c) = [D(a to c) + D(b to c)] / 2
D(ab to c) = [ 21 + 30 ] / 2
D(ab to c) = [ 21 + 30 ] / 2
D(ab to c) = 25.5</p>
<p>Dab_c = [Da_c + Db_c] / 2
Dab_c = 25.5</p>
<p>The math in the wikipedia article is more accurately written out as this, which is more similar to Swofford’s notation.</p>
<p>D(ab to c) = [T.i<em>D(a to c) + T.j</em>D(b to c)] / 2
D(ab to c) = [1<em>D(a to c) + 1</em>D(b to c)] / (1+1)
D(ab to c) = [ 1<em>21 + 1</em>30 ] / (1+1)
D(ab to c) = [ 1<em>21 + 1</em>30 ] / (1+1)
D(ab to c) = 25.5</p>
<p>Dab_c = [1<em>Da_c + 1</em>Db_c] / (1+1)
Dab_c = 25.5</p>
<p>Using Swofford et al’s notation we’d do this:</p>
<p>d.ku = (Ti x d.ki + Tj x d.kj)/(Ti + Tj)</p>
<p>I’ll just switch the subscripts to be consistent with the Wikipedia notation</p>
<p>d.uk = (Ti x d.ik + Tj x d.jk)/(Ti + Tj)</p>
<p>where</p>
<p>u = our new cluster ab
k = the remaining clusters; we’ll start with c
Ti, Tj = the number of clusters the constitute the clusters that were just combined. This starts out at 1.
Ti = Ta = 1
Tj = Tb = 1
d.ik = the distance from cluster i to the reamining clusters; we’ll start with c
d.ik = d.ac = 21
d.jk = d.bc = 30</p>
<p>d.ku = (Ti x d.ik + Tj x d.jk)/(Ti + Tj)
d.ku = (1 x 21 + 1 x 30 )/( 1 + 1 )
d.ku = ( 21 + 30 )/(2)
d.ku = 51/2
d.ku = 25.5</p>
<p>The Swofford notation is more generic and useful because in the next iteration we’ll have a cluster of ab which will have two taxa in it.</p>
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb896-1"><a href="upgma-the-hard-way.html#cb896-1" aria-hidden="true" tabindex="-1"></a>Ta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb896-2"><a href="upgma-the-hard-way.html#cb896-2" aria-hidden="true" tabindex="-1"></a>Tb <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb896-3"><a href="upgma-the-hard-way.html#cb896-3" aria-hidden="true" tabindex="-1"></a>Da_c <span class="ot">&lt;-</span> <span class="dv">21</span></span>
<span id="cb896-4"><a href="upgma-the-hard-way.html#cb896-4" aria-hidden="true" tabindex="-1"></a>Db_c <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb896-5"><a href="upgma-the-hard-way.html#cb896-5" aria-hidden="true" tabindex="-1"></a>Dab_c <span class="ot">&lt;-</span> (Ta<span class="sc">*</span>Da_c<span class="sc">+</span>Tb<span class="sc">*</span>Db_c)<span class="sc">/</span><span class="dv">2</span></span></code></pre></div>
</div>
<div id="ab-to-d" class="section level4" number="40.8.4.2">
<h4><span class="header-section-number">40.8.4.2</span> ab to d</h4>
<p>We now continue for the other distances. I’ll stick to the wikipedia notation for now.</p>
<p>D(ab to d) = [D(a to d) + D(b to d)] / 2
D(ab to d) = [ 31 + 34 ] / 2
D(ab to d) = [ 31 + 34 ] / 2
D(ab to d) = 32.5</p>
<p>Dab_d = [Da_d + Db_d] / 2
Dab_d = 32.5</p>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb897-1"><a href="upgma-the-hard-way.html#cb897-1" aria-hidden="true" tabindex="-1"></a>Da_d <span class="ot">&lt;-</span> <span class="dv">31</span></span>
<span id="cb897-2"><a href="upgma-the-hard-way.html#cb897-2" aria-hidden="true" tabindex="-1"></a>Db_d <span class="ot">&lt;-</span> <span class="dv">34</span></span>
<span id="cb897-3"><a href="upgma-the-hard-way.html#cb897-3" aria-hidden="true" tabindex="-1"></a>Dab_d <span class="ot">&lt;-</span> (Da_d<span class="sc">+</span>Db_d)<span class="sc">/</span><span class="dv">2</span></span></code></pre></div>
</div>
<div id="ab-to-e" class="section level4" number="40.8.4.3">
<h4><span class="header-section-number">40.8.4.3</span> ab to e</h4>
<p>D(ab to d) = [D(a to d) + D(b to d)] / 2
D(ab to d) = [ 23 + 21 ] / 2
D(ab to d) = [ 23 + 21 ] / 2
D(ab to d) = Dab_e</p>
<p>Dab_d = [Da_d + Db_d] / 2
Dab_d = Dab_e</p>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="upgma-the-hard-way.html#cb898-1" aria-hidden="true" tabindex="-1"></a>Da_e <span class="ot">&lt;-</span> <span class="dv">23</span></span>
<span id="cb898-2"><a href="upgma-the-hard-way.html#cb898-2" aria-hidden="true" tabindex="-1"></a>Db_e <span class="ot">&lt;-</span> <span class="dv">21</span></span>
<span id="cb898-3"><a href="upgma-the-hard-way.html#cb898-3" aria-hidden="true" tabindex="-1"></a>Dab_e <span class="ot">&lt;-</span> (Da_e<span class="sc">+</span>Db_e)<span class="sc">/</span><span class="dv">2</span></span></code></pre></div>
</div>
</div>
<div id="update-matrix-with-new-distance" class="section level3" number="40.8.5">
<h3><span class="header-section-number">40.8.5</span> Update matrix with new distance</h3>
<p>Old matrix has distances from a and b to all other points: we want to replace these. distances among c, d, and e are still the same values.</p>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="upgma-the-hard-way.html#cb899-1" aria-hidden="true" tabindex="-1"></a>dmat1</span></code></pre></div>
<pre><code>##    a  b  c  d  e
## a NA NA NA NA NA
## b 17 NA NA NA NA
## c 21 30 NA NA NA
## d 31 34 28 NA NA
## e 23 21 39 43 NA</code></pre>
<div id="illustration" class="section level4" number="40.8.5.1">
<h4><span class="header-section-number">40.8.5.1</span> Illustration</h4>
<p>Values in parenthesese will be REPLACED</p>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb901-1"><a href="upgma-the-hard-way.html#cb901-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb901-2"><a href="upgma-the-hard-way.html#cb901-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;(17)&quot;</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb901-3"><a href="upgma-the-hard-way.html#cb901-3" aria-hidden="true" tabindex="-1"></a>c   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;(21)&quot;</span>, <span class="st">&quot;(30)&quot;</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb901-4"><a href="upgma-the-hard-way.html#cb901-4" aria-hidden="true" tabindex="-1"></a>d   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;(31)&quot;</span>, <span class="st">&quot;(34)&quot;</span>, <span class="st">&quot;28&quot;</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb901-5"><a href="upgma-the-hard-way.html#cb901-5" aria-hidden="true" tabindex="-1"></a>e   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;(23)&quot;</span>, <span class="st">&quot;(21)&quot;</span>, <span class="st">&quot;39&quot;</span>, <span class="st">&quot;43&quot;</span>,    <span class="cn">NA</span>)</span>
<span id="cb901-6"><a href="upgma-the-hard-way.html#cb901-6" aria-hidden="true" tabindex="-1"></a>dmat1.alt <span class="ot">&lt;-</span> <span class="fu">rbind</span>(a,b,c,d,e)</span>
<span id="cb901-7"><a href="upgma-the-hard-way.html#cb901-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dmat1.alt) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)</span>
<span id="cb901-8"><a href="upgma-the-hard-way.html#cb901-8" aria-hidden="true" tabindex="-1"></a>dmat1.alt</span></code></pre></div>
<pre><code>##   a      b      c    d    e 
## a NA     NA     NA   NA   NA
## b &quot;(17)&quot; NA     NA   NA   NA
## c &quot;(21)&quot; &quot;(30)&quot; NA   NA   NA
## d &quot;(31)&quot; &quot;(34)&quot; &quot;28&quot; NA   NA
## e &quot;(23)&quot; &quot;(21)&quot; &quot;39&quot; &quot;43&quot; NA</code></pre>
<p>Create smaller matrix with clade ab</p>
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb903-1"><a href="upgma-the-hard-way.html#cb903-1" aria-hidden="true" tabindex="-1"></a><span class="co">#       ab      c   d   e</span></span>
<span id="cb903-2"><a href="upgma-the-hard-way.html#cb903-2" aria-hidden="true" tabindex="-1"></a>ab  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>,    <span class="cn">NA</span>,  <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb903-3"><a href="upgma-the-hard-way.html#cb903-3" aria-hidden="true" tabindex="-1"></a>c     <span class="ot">&lt;-</span> <span class="fu">c</span>(Dab_c, <span class="cn">NA</span>,  <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb903-4"><a href="upgma-the-hard-way.html#cb903-4" aria-hidden="true" tabindex="-1"></a>d     <span class="ot">&lt;-</span> <span class="fu">c</span>(Dab_d, <span class="dv">28</span>,    <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb903-5"><a href="upgma-the-hard-way.html#cb903-5" aria-hidden="true" tabindex="-1"></a>e     <span class="ot">&lt;-</span> <span class="fu">c</span>(Dab_e, <span class="dv">39</span>,  <span class="dv">43</span>, <span class="cn">NA</span>)</span>
<span id="cb903-6"><a href="upgma-the-hard-way.html#cb903-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb903-7"><a href="upgma-the-hard-way.html#cb903-7" aria-hidden="true" tabindex="-1"></a>dmat2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ab,c,d,e)</span>
<span id="cb903-8"><a href="upgma-the-hard-way.html#cb903-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dmat2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ab&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)</span></code></pre></div>
</div>
<div id="estimate-2-d" class="section level4" number="40.8.5.2">
<h4><span class="header-section-number">40.8.5.2</span> Estimate 2 D</h4>
<p>Estimate of 2D representation of the new matrix.</p>
<div class="sourceCode" id="cb904"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb904-1"><a href="upgma-the-hard-way.html#cb904-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_dist_as_nmds</span>(dmat2)</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-602-1.png" width="672" /></p>
<pre><code>## $points
##          [,1]       [,2]
## ab  13.453890 -3.0373250
## c   -6.600828 13.4680501
## d  -16.726270 -8.5744114
## e   19.948871 -0.6844397
## 
## $eig
## NULL
## 
## $x
## NULL
## 
## $ac
## [1] -4.570935e-15
## 
## $GOF
## [1] 0.7573625 1.0000000</code></pre>
</div>
</div>
</div>
<div id="algorithm---next-round" class="section level2" number="40.9">
<h2><span class="header-section-number">40.9</span> Algorithm - next round</h2>
<p>We’ve combined a and b and calculated the disnace of this clade (a,b) to the remaining taxa. What is now the minimum distance?</p>
<p>The minimum distance of the current matrix</p>
<div class="sourceCode" id="cb906"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb906-1"><a href="upgma-the-hard-way.html#cb906-1" aria-hidden="true" tabindex="-1"></a>dist.min.i <span class="ot">&lt;-</span> <span class="fu">min</span>(dmat2, <span class="at">na.rm =</span> T)</span></code></pre></div>
<p>The index value of the current minimum</p>
<div class="sourceCode" id="cb907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb907-1"><a href="upgma-the-hard-way.html#cb907-1" aria-hidden="true" tabindex="-1"></a>index.min.i <span class="ot">&lt;-</span> <span class="fu">which</span>(dmat2 <span class="sc">==</span> dist.min.i, <span class="at">arr.ind =</span>T)</span>
<span id="cb907-2"><a href="upgma-the-hard-way.html#cb907-2" aria-hidden="true" tabindex="-1"></a>index.row.i <span class="ot">&lt;-</span> index.min.i[<span class="dv">1</span>]</span>
<span id="cb907-3"><a href="upgma-the-hard-way.html#cb907-3" aria-hidden="true" tabindex="-1"></a>index.col.i <span class="ot">&lt;-</span> index.min.i[<span class="dv">2</span>]</span></code></pre></div>
<p>We can get the names of our taxa using the</p>
<div class="sourceCode" id="cb908"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb908-1"><a href="upgma-the-hard-way.html#cb908-1" aria-hidden="true" tabindex="-1"></a>cluster.i2 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(dmat2)[index.row.i]</span>
<span id="cb908-2"><a href="upgma-the-hard-way.html#cb908-2" aria-hidden="true" tabindex="-1"></a>cluster.i1 <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dmat2)[index.col.i]</span></code></pre></div>
<p>Add output to dataframe</p>
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb909-1"><a href="upgma-the-hard-way.html#cb909-1" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">2</span>,<span class="st">&quot;clust.i&quot;</span>] <span class="ot">&lt;-</span> cluster.i1</span>
<span id="cb909-2"><a href="upgma-the-hard-way.html#cb909-2" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">2</span>,<span class="st">&quot;clust.j&quot;</span>] <span class="ot">&lt;-</span> cluster.i2</span>
<span id="cb909-3"><a href="upgma-the-hard-way.html#cb909-3" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">2</span>,<span class="st">&quot;dist.ij&quot;</span>] <span class="ot">&lt;-</span> dist.min.i</span></code></pre></div>
<div id="combine-species-into-clade-1" class="section level3" number="40.9.1">
<h3><span class="header-section-number">40.9.1</span> Combine species into clade</h3>
<p>Combine the two taxa names into a new name. This can be done a couple ways.</p>
<div class="sourceCode" id="cb910"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb910-1"><a href="upgma-the-hard-way.html#cb910-1" aria-hidden="true" tabindex="-1"></a>clade.i <span class="ot">&lt;-</span> <span class="st">&quot;abe&quot;</span></span>
<span id="cb910-2"><a href="upgma-the-hard-way.html#cb910-2" aria-hidden="true" tabindex="-1"></a>clade.i <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;ab&quot;</span>,<span class="st">&quot;e&quot;</span>,<span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb910-3"><a href="upgma-the-hard-way.html#cb910-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb910-4"><a href="upgma-the-hard-way.html#cb910-4" aria-hidden="true" tabindex="-1"></a>clade.i <span class="ot">&lt;-</span> <span class="fu">paste</span>(cluster.i1,cluster.i2, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>We’ll add this to the dataframe</p>
<div class="sourceCode" id="cb911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb911-1"><a href="upgma-the-hard-way.html#cb911-1" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">2</span>,<span class="st">&quot;clust.u&quot;</span>] <span class="ot">&lt;-</span> clade.i</span></code></pre></div>
</div>
<div id="calculate-branch-length-1" class="section level3" number="40.9.2">
<h3><span class="header-section-number">40.9.2</span> Calculate branch length</h3>
<p>Branch length is distance/2 or d.ij/2 = d.ab.e = 22/2</p>
<div class="sourceCode" id="cb912"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb912-1"><a href="upgma-the-hard-way.html#cb912-1" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">2</span>,<span class="st">&quot;branch.l.ij&quot;</span>] <span class="ot">&lt;-</span> UPGMA_output[<span class="dv">2</span>,<span class="st">&quot;dist.ij&quot;</span>]<span class="sc">/</span><span class="dv">2</span></span></code></pre></div>
</div>
<div id="recalculate-distance-from-abe-to-all-remainign-taxa" class="section level3" number="40.9.3">
<h3><span class="header-section-number">40.9.3</span> Recalculate distance from abe to all remainign taxa</h3>
<p>In the current matrix, the smallest distance is between ab and e</p>
<p>We therefore want to form a clade between ab and e (abe), the measure the distance from this clade to allthe other species.</p>
<p>Visualize this as an approximate 2D situation</p>
<div class="sourceCode" id="cb913"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb913-1"><a href="upgma-the-hard-way.html#cb913-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb913-2"><a href="upgma-the-hard-way.html#cb913-2" aria-hidden="true" tabindex="-1"></a>dmat2.out <span class="ot">&lt;-</span> <span class="fu">plot_dist_as_nmds</span>(dmat2)</span>
<span id="cb913-3"><a href="upgma-the-hard-way.html#cb913-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb913-4"><a href="upgma-the-hard-way.html#cb913-4" aria-hidden="true" tabindex="-1"></a><span class="co">#get x y coord of ab and e</span></span>
<span id="cb913-5"><a href="upgma-the-hard-way.html#cb913-5" aria-hidden="true" tabindex="-1"></a>ab.<span class="ot">&lt;-</span>dmat2.out<span class="sc">$</span>points[<span class="st">&quot;ab&quot;</span>,]</span>
<span id="cb913-6"><a href="upgma-the-hard-way.html#cb913-6" aria-hidden="true" tabindex="-1"></a>e.<span class="ot">&lt;-</span>dmat2.out<span class="sc">$</span>points[<span class="st">&quot;e&quot;</span>,]</span>
<span id="cb913-7"><a href="upgma-the-hard-way.html#cb913-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb913-8"><a href="upgma-the-hard-way.html#cb913-8" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.ellipse</span>(<span class="at">x =</span> <span class="fu">mean</span>(<span class="fu">c</span>(ab.[<span class="dv">1</span>],e.[<span class="dv">1</span>])), </span>
<span id="cb913-9"><a href="upgma-the-hard-way.html#cb913-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fu">mean</span>(<span class="fu">c</span>(ab.[<span class="dv">2</span>],e.[<span class="dv">2</span>])),</span>
<span id="cb913-10"><a href="upgma-the-hard-way.html#cb913-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">a =</span><span class="dv">7</span>, </span>
<span id="cb913-11"><a href="upgma-the-hard-way.html#cb913-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">b =</span> <span class="dv">7</span>, </span>
<span id="cb913-12"><a href="upgma-the-hard-way.html#cb913-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">angle =</span> <span class="dv">0</span>)</span>
<span id="cb913-13"><a href="upgma-the-hard-way.html#cb913-13" aria-hidden="true" tabindex="-1"></a>c.<span class="ot">&lt;-</span>dmat2.out<span class="sc">$</span>points[<span class="st">&quot;c&quot;</span>,]</span>
<span id="cb913-14"><a href="upgma-the-hard-way.html#cb913-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb913-15"><a href="upgma-the-hard-way.html#cb913-15" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> ab.[<span class="dv">1</span>],<span class="at">x1 =</span> c.[<span class="dv">1</span>],</span>
<span id="cb913-16"><a href="upgma-the-hard-way.html#cb913-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">y0 =</span> ab.[<span class="dv">2</span>],<span class="at">y1 =</span> c.[<span class="dv">2</span>])</span>
<span id="cb913-17"><a href="upgma-the-hard-way.html#cb913-17" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> e.[<span class="dv">1</span>],<span class="at">x1 =</span> c.[<span class="dv">1</span>],</span>
<span id="cb913-18"><a href="upgma-the-hard-way.html#cb913-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">y0 =</span> e.[<span class="dv">2</span>],<span class="at">y1 =</span> c.[<span class="dv">2</span>]) </span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-610-1.png" width="672" /></p>
<div id="abe-to-c" class="section level4" number="40.9.3.1">
<h4><span class="header-section-number">40.9.3.1</span> abe to c</h4>
<p>NOTE: calculations are “weighted” in proportion number of species in clade.
So D(ab to c) is multiplied by two because ab is 2 species</p>
<p>The denominators is 3 because of the weights used in the numerator.</p>
<p>The notation in the Wikipedia article is:</p>
<p>D(abe to c) = [D(ab to c)<em>2 + D(e to c)</em>1] / (2+1)
D(abe to c) = [ 25.5<em>2 + 39</em>1 ] / (2+1)
D(abe to c) = [ 25.5<em>2 + 39</em>1 ] / (2+1)
D(abe to c) = 32.5</p>
<p>Dabe_c = [Dab_c<em>2 + De_c</em>1] / (2+1)
Dabe_c = 32.5</p>
<div class="sourceCode" id="cb914"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb914-1"><a href="upgma-the-hard-way.html#cb914-1" aria-hidden="true" tabindex="-1"></a>Dab_c <span class="ot">&lt;-</span> <span class="fl">25.5</span></span>
<span id="cb914-2"><a href="upgma-the-hard-way.html#cb914-2" aria-hidden="true" tabindex="-1"></a>De_c  <span class="ot">&lt;-</span> <span class="dv">39</span></span>
<span id="cb914-3"><a href="upgma-the-hard-way.html#cb914-3" aria-hidden="true" tabindex="-1"></a>Dabe_c <span class="ot">&lt;-</span> (Dab_c<span class="sc">*</span><span class="dv">2</span> <span class="sc">+</span> De_c<span class="sc">*</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="abe-to-c-1" class="section level4" number="40.9.3.2">
<h4><span class="header-section-number">40.9.3.2</span> abe to c</h4>
<p>For abe to d</p>
<div class="sourceCode" id="cb915"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb915-1"><a href="upgma-the-hard-way.html#cb915-1" aria-hidden="true" tabindex="-1"></a>Dab_d <span class="ot">&lt;-</span> <span class="fl">32.5</span></span>
<span id="cb915-2"><a href="upgma-the-hard-way.html#cb915-2" aria-hidden="true" tabindex="-1"></a>De_d  <span class="ot">&lt;-</span> <span class="dv">43</span></span>
<span id="cb915-3"><a href="upgma-the-hard-way.html#cb915-3" aria-hidden="true" tabindex="-1"></a>Dabe_d <span class="ot">&lt;-</span> (Dab_d<span class="sc">*</span><span class="dv">2</span> <span class="sc">+</span> De_d<span class="sc">*</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span></code></pre></div>
</div>
</div>
<div id="update-the-matrix" class="section level3" number="40.9.4">
<h3><span class="header-section-number">40.9.4</span> Update the matrix</h3>
<div class="sourceCode" id="cb916"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb916-1"><a href="upgma-the-hard-way.html#cb916-1" aria-hidden="true" tabindex="-1"></a>abe <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>,     <span class="cn">NA</span>,  <span class="cn">NA</span>)</span>
<span id="cb916-2"><a href="upgma-the-hard-way.html#cb916-2" aria-hidden="true" tabindex="-1"></a>c      <span class="ot">&lt;-</span> <span class="fu">c</span>(Dabe_c, <span class="cn">NA</span>,  <span class="cn">NA</span>)</span>
<span id="cb916-3"><a href="upgma-the-hard-way.html#cb916-3" aria-hidden="true" tabindex="-1"></a>d      <span class="ot">&lt;-</span> <span class="fu">c</span>(Dabe_d, <span class="dv">28</span>,  <span class="cn">NA</span>)</span>
<span id="cb916-4"><a href="upgma-the-hard-way.html#cb916-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb916-5"><a href="upgma-the-hard-way.html#cb916-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb916-6"><a href="upgma-the-hard-way.html#cb916-6" aria-hidden="true" tabindex="-1"></a>dmat3 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(abe,c,d)</span>
<span id="cb916-7"><a href="upgma-the-hard-way.html#cb916-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dmat3) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;abe&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="next-iteration" class="section level2" number="40.10">
<h2><span class="header-section-number">40.10</span> Next iteration</h2>
<div id="estimate-2-d-1" class="section level4" number="40.10.0.1">
<h4><span class="header-section-number">40.10.0.1</span> Estimate 2 D</h4>
<p>a, b, e are now combined into a clade</p>
<div class="sourceCode" id="cb917"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb917-1"><a href="upgma-the-hard-way.html#cb917-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb917-2"><a href="upgma-the-hard-way.html#cb917-2" aria-hidden="true" tabindex="-1"></a>dmat3.out <span class="ot">&lt;-</span> <span class="fu">plot_dist_as_nmds</span>(dmat3)</span>
<span id="cb917-3"><a href="upgma-the-hard-way.html#cb917-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb917-4"><a href="upgma-the-hard-way.html#cb917-4" aria-hidden="true" tabindex="-1"></a><span class="co">#get x y coord of ab and e</span></span>
<span id="cb917-5"><a href="upgma-the-hard-way.html#cb917-5" aria-hidden="true" tabindex="-1"></a>c. <span class="ot">&lt;-</span>dmat3.out<span class="sc">$</span>points[<span class="st">&quot;c&quot;</span>,]</span>
<span id="cb917-6"><a href="upgma-the-hard-way.html#cb917-6" aria-hidden="true" tabindex="-1"></a>d.<span class="ot">&lt;-</span>dmat3.out<span class="sc">$</span>points[<span class="st">&quot;d&quot;</span>,]</span>
<span id="cb917-7"><a href="upgma-the-hard-way.html#cb917-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb917-8"><a href="upgma-the-hard-way.html#cb917-8" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.ellipse</span>(<span class="at">x =</span> <span class="fu">mean</span>(<span class="fu">c</span>(c.[<span class="dv">1</span>],d.[<span class="dv">1</span>])), </span>
<span id="cb917-9"><a href="upgma-the-hard-way.html#cb917-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fu">mean</span>(<span class="fu">c</span>(c.[<span class="dv">2</span>],d.[<span class="dv">2</span>])),</span>
<span id="cb917-10"><a href="upgma-the-hard-way.html#cb917-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">a =</span><span class="dv">14</span>, </span>
<span id="cb917-11"><a href="upgma-the-hard-way.html#cb917-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">b =</span> <span class="dv">4</span>, </span>
<span id="cb917-12"><a href="upgma-the-hard-way.html#cb917-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">angle =</span> <span class="dv">105</span>)</span>
<span id="cb917-13"><a href="upgma-the-hard-way.html#cb917-13" aria-hidden="true" tabindex="-1"></a>abe.<span class="ot">&lt;-</span>dmat3.out<span class="sc">$</span>points[<span class="st">&quot;abe&quot;</span>,]</span>
<span id="cb917-14"><a href="upgma-the-hard-way.html#cb917-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb917-15"><a href="upgma-the-hard-way.html#cb917-15" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> c.[<span class="dv">1</span>],<span class="at">x1 =</span> abe.[<span class="dv">1</span>],</span>
<span id="cb917-16"><a href="upgma-the-hard-way.html#cb917-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">y0 =</span> c.[<span class="dv">2</span>],<span class="at">y1 =</span> abe.[<span class="dv">2</span>])</span>
<span id="cb917-17"><a href="upgma-the-hard-way.html#cb917-17" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> d.[<span class="dv">1</span>],<span class="at">x1 =</span> abe.[<span class="dv">1</span>],</span>
<span id="cb917-18"><a href="upgma-the-hard-way.html#cb917-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">y0 =</span> d.[<span class="dv">2</span>],<span class="at">y1 =</span> abe.[<span class="dv">2</span>]) </span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-614-1.png" width="672" /></p>
</div>
<div id="calculate-branch-lengths" class="section level3" number="40.10.1">
<h3><span class="header-section-number">40.10.1</span> Calculate branch lengths</h3>
<p>The minimum distance of the current matrix</p>
<div class="sourceCode" id="cb918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb918-1"><a href="upgma-the-hard-way.html#cb918-1" aria-hidden="true" tabindex="-1"></a>dist.min.i <span class="ot">&lt;-</span> <span class="fu">min</span>(dmat3, <span class="at">na.rm =</span> T)</span></code></pre></div>
<p>The index value of the current minimum</p>
<div class="sourceCode" id="cb919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb919-1"><a href="upgma-the-hard-way.html#cb919-1" aria-hidden="true" tabindex="-1"></a>index.min.i <span class="ot">&lt;-</span> <span class="fu">which</span>(dmat3 <span class="sc">==</span> dist.min.i, <span class="at">arr.ind =</span>T)</span>
<span id="cb919-2"><a href="upgma-the-hard-way.html#cb919-2" aria-hidden="true" tabindex="-1"></a>index.row.i <span class="ot">&lt;-</span> index.min.i[<span class="dv">1</span>]</span>
<span id="cb919-3"><a href="upgma-the-hard-way.html#cb919-3" aria-hidden="true" tabindex="-1"></a>index.col.i <span class="ot">&lt;-</span> index.min.i[<span class="dv">2</span>]</span></code></pre></div>
<p>We can get the names of our taxa using the</p>
<div class="sourceCode" id="cb920"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb920-1"><a href="upgma-the-hard-way.html#cb920-1" aria-hidden="true" tabindex="-1"></a>cluster.i2 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(dmat3)[index.row.i]</span>
<span id="cb920-2"><a href="upgma-the-hard-way.html#cb920-2" aria-hidden="true" tabindex="-1"></a>cluster.i1 <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dmat3)[index.col.i]</span></code></pre></div>
<p>Add output to dataframe</p>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb921-1"><a href="upgma-the-hard-way.html#cb921-1" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">3</span>,<span class="st">&quot;clust.i&quot;</span>] <span class="ot">&lt;-</span> cluster.i1</span>
<span id="cb921-2"><a href="upgma-the-hard-way.html#cb921-2" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">3</span>,<span class="st">&quot;clust.j&quot;</span>] <span class="ot">&lt;-</span> cluster.i2</span>
<span id="cb921-3"><a href="upgma-the-hard-way.html#cb921-3" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">3</span>,<span class="st">&quot;dist.ij&quot;</span>] <span class="ot">&lt;-</span> dist.min.i</span></code></pre></div>
</div>
<div id="combine-species-into-clade-2" class="section level3" number="40.10.2">
<h3><span class="header-section-number">40.10.2</span> Combine species into clade</h3>
<p>Combine the two taxa names into a new name. This can be done a couple ways.</p>
<div class="sourceCode" id="cb922"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb922-1"><a href="upgma-the-hard-way.html#cb922-1" aria-hidden="true" tabindex="-1"></a>clade.i <span class="ot">&lt;-</span> <span class="st">&quot;cd&quot;</span></span>
<span id="cb922-2"><a href="upgma-the-hard-way.html#cb922-2" aria-hidden="true" tabindex="-1"></a>clade.i <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb922-3"><a href="upgma-the-hard-way.html#cb922-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb922-4"><a href="upgma-the-hard-way.html#cb922-4" aria-hidden="true" tabindex="-1"></a>clade.i <span class="ot">&lt;-</span> <span class="fu">paste</span>(cluster.i1,cluster.i2, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>We’ll add this to the dataframe</p>
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb923-1"><a href="upgma-the-hard-way.html#cb923-1" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">3</span>,<span class="st">&quot;clust.u&quot;</span>] <span class="ot">&lt;-</span> clade.i</span></code></pre></div>
</div>
<div id="calculate-branch-length-2" class="section level3" number="40.10.3">
<h3><span class="header-section-number">40.10.3</span> Calculate branch length</h3>
<p>Branch length is distance/2 or d.ij/2 = d.d.e = 28/2</p>
<div class="sourceCode" id="cb924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb924-1"><a href="upgma-the-hard-way.html#cb924-1" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">3</span>,<span class="st">&quot;branch.l.ij&quot;</span>] <span class="ot">&lt;-</span> UPGMA_output[<span class="dv">3</span>,<span class="st">&quot;dist.ij&quot;</span>]<span class="sc">/</span><span class="dv">2</span></span></code></pre></div>
</div>
<div id="distance-of-c-to-abe-and-d-to-abe" class="section level3" number="40.10.4">
<h3><span class="header-section-number">40.10.4</span> Distance of c to abe and d to abe</h3>
<div class="sourceCode" id="cb925"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb925-1"><a href="upgma-the-hard-way.html#cb925-1" aria-hidden="true" tabindex="-1"></a>Dc_abe <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb925-2"><a href="upgma-the-hard-way.html#cb925-2" aria-hidden="true" tabindex="-1"></a>Dd_abe <span class="ot">&lt;-</span> <span class="dv">36</span></span>
<span id="cb925-3"><a href="upgma-the-hard-way.html#cb925-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb925-4"><a href="upgma-the-hard-way.html#cb925-4" aria-hidden="true" tabindex="-1"></a><span class="co"># abe is composted of 3 </span></span>
<span id="cb925-5"><a href="upgma-the-hard-way.html#cb925-5" aria-hidden="true" tabindex="-1"></a>Ddc_abe <span class="ot">&lt;-</span> (Dc_abe<span class="sc">*</span><span class="dv">3</span> <span class="sc">+</span> Dd_abe<span class="sc">*</span><span class="dv">3</span>)<span class="sc">/</span>(<span class="dv">3</span><span class="sc">+</span><span class="dv">3</span>)</span>
<span id="cb925-6"><a href="upgma-the-hard-way.html#cb925-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb925-7"><a href="upgma-the-hard-way.html#cb925-7" aria-hidden="true" tabindex="-1"></a><span class="co"># factor out 3</span></span>
<span id="cb925-8"><a href="upgma-the-hard-way.html#cb925-8" aria-hidden="true" tabindex="-1"></a>Ddc_abe <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">*</span>(Dc_abe<span class="sc">*</span><span class="dv">1</span> <span class="sc">+</span> Dd_abe<span class="sc">*</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">6</span></span>
<span id="cb925-9"><a href="upgma-the-hard-way.html#cb925-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb925-10"><a href="upgma-the-hard-way.html#cb925-10" aria-hidden="true" tabindex="-1"></a><span class="co"># simplify</span></span>
<span id="cb925-11"><a href="upgma-the-hard-way.html#cb925-11" aria-hidden="true" tabindex="-1"></a>Ddc_abe <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>(Dc_abe<span class="sc">*</span><span class="dv">1</span> <span class="sc">+</span> Dd_abe<span class="sc">*</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb925-12"><a href="upgma-the-hard-way.html#cb925-12" aria-hidden="true" tabindex="-1"></a>Ddc_abe <span class="ot">&lt;-</span> (Dc_abe<span class="sc">*</span><span class="dv">1</span> <span class="sc">+</span> Dd_abe)<span class="sc">/</span><span class="dv">2</span></span></code></pre></div>
<p>Create matrix</p>
<div class="sourceCode" id="cb926"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb926-1"><a href="upgma-the-hard-way.html#cb926-1" aria-hidden="true" tabindex="-1"></a>abe <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>,     <span class="cn">NA</span>)</span>
<span id="cb926-2"><a href="upgma-the-hard-way.html#cb926-2" aria-hidden="true" tabindex="-1"></a>cd   <span class="ot">&lt;-</span> <span class="fu">c</span>(Ddc_abe, <span class="cn">NA</span>)</span>
<span id="cb926-3"><a href="upgma-the-hard-way.html#cb926-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb926-4"><a href="upgma-the-hard-way.html#cb926-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb926-5"><a href="upgma-the-hard-way.html#cb926-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb926-6"><a href="upgma-the-hard-way.html#cb926-6" aria-hidden="true" tabindex="-1"></a>dmat4 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(abe,cd)</span>
<span id="cb926-7"><a href="upgma-the-hard-way.html#cb926-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dmat4) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;abe&quot;</span>,<span class="st">&quot;cd&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="finish-up" class="section level2" number="40.11">
<h2><span class="header-section-number">40.11</span> Finish up</h2>
<p>The final entry of the matrix is 33. This means that the distnace from the clade abe to the clade de is 33, with branch length of 33/2 = 16.5</p>
<p>The minimum distance</p>
<div class="sourceCode" id="cb927"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb927-1"><a href="upgma-the-hard-way.html#cb927-1" aria-hidden="true" tabindex="-1"></a>dist.min.i <span class="ot">&lt;-</span> <span class="fu">min</span>(dmat4, <span class="at">na.rm =</span> T)</span></code></pre></div>
<p>The index value of the minimum</p>
<div class="sourceCode" id="cb928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb928-1"><a href="upgma-the-hard-way.html#cb928-1" aria-hidden="true" tabindex="-1"></a>index.min.i <span class="ot">&lt;-</span> <span class="fu">which</span>(dmat4 <span class="sc">==</span> dist.min.i, <span class="at">arr.ind =</span>T)</span>
<span id="cb928-2"><a href="upgma-the-hard-way.html#cb928-2" aria-hidden="true" tabindex="-1"></a>index.row.i <span class="ot">&lt;-</span> index.min.i[<span class="dv">1</span>]</span>
<span id="cb928-3"><a href="upgma-the-hard-way.html#cb928-3" aria-hidden="true" tabindex="-1"></a>index.col.i <span class="ot">&lt;-</span> index.min.i[<span class="dv">2</span>]</span></code></pre></div>
<p>We can get the names of our taxa using the</p>
<div class="sourceCode" id="cb929"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb929-1"><a href="upgma-the-hard-way.html#cb929-1" aria-hidden="true" tabindex="-1"></a>cluster.i2 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(dmat4)[index.row.i]</span>
<span id="cb929-2"><a href="upgma-the-hard-way.html#cb929-2" aria-hidden="true" tabindex="-1"></a>cluster.i1 <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dmat4)[index.col.i]</span></code></pre></div>
<p>Add output to dataframe</p>
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb930-1"><a href="upgma-the-hard-way.html#cb930-1" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">4</span>,<span class="st">&quot;clust.i&quot;</span>] <span class="ot">&lt;-</span> cluster.i1</span>
<span id="cb930-2"><a href="upgma-the-hard-way.html#cb930-2" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">4</span>,<span class="st">&quot;clust.j&quot;</span>] <span class="ot">&lt;-</span> cluster.i2</span>
<span id="cb930-3"><a href="upgma-the-hard-way.html#cb930-3" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">4</span>,<span class="st">&quot;dist.ij&quot;</span>] <span class="ot">&lt;-</span> dist.min.i</span></code></pre></div>
<div id="combine-species-into-clade-3" class="section level3" number="40.11.1">
<h3><span class="header-section-number">40.11.1</span> Combine species into clade</h3>
<p>Combine the two taxa names into a new name. This can be done a couple ways.</p>
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb931-1"><a href="upgma-the-hard-way.html#cb931-1" aria-hidden="true" tabindex="-1"></a>clade.i <span class="ot">&lt;-</span> <span class="fu">paste</span>(cluster.i1,cluster.i2, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>We’ll add this to the dataframe</p>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb932-1"><a href="upgma-the-hard-way.html#cb932-1" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">4</span>,<span class="st">&quot;clust.u&quot;</span>] <span class="ot">&lt;-</span> clade.i</span></code></pre></div>
</div>
<div id="calculate-branch-length-3" class="section level3" number="40.11.2">
<h3><span class="header-section-number">40.11.2</span> Calculate branch length</h3>
<p>Branch length is distance/2 or d.ij/2</p>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb933-1"><a href="upgma-the-hard-way.html#cb933-1" aria-hidden="true" tabindex="-1"></a>UPGMA_output[<span class="dv">4</span>,<span class="st">&quot;branch.l.ij&quot;</span>] <span class="ot">&lt;-</span> UPGMA_output[<span class="dv">4</span>,<span class="st">&quot;dist.ij&quot;</span>]<span class="sc">/</span><span class="dv">2</span></span></code></pre></div>
</div>
</div>
<div id="finalizing-branch-lengths" class="section level2" number="40.12">
<h2><span class="header-section-number">40.12</span> Finalizing branch lengths</h2>
<p>We now have a final tree structure. In Newick format it would be</p>
<div class="sourceCode" id="cb934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb934-1"><a href="upgma-the-hard-way.html#cb934-1" aria-hidden="true" tabindex="-1"></a>full.tree <span class="ot">&lt;-</span> <span class="st">&quot;((c,d),(e,(b, a)));&quot;</span> <span class="co"># semi colon!</span></span>
<span id="cb934-2"><a href="upgma-the-hard-way.html#cb934-2" aria-hidden="true" tabindex="-1"></a>full.tree <span class="ot">&lt;-</span><span class="fu">read.tree</span>(<span class="at">text=</span>full.tree)</span>
<span id="cb934-3"><a href="upgma-the-hard-way.html#cb934-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(full.tree, <span class="at">main =</span> <span class="st">&quot;3-taxa tree&quot;</span>)</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-631-1.png" width="672" /></p>
<p>While we’ve done our clustering we’ve calcualte branch lengths and put them in the column branch.l.ij of the dataframe UPGMA_output</p>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb935-1"><a href="upgma-the-hard-way.html#cb935-1" aria-hidden="true" tabindex="-1"></a>UPGMA_output</span></code></pre></div>
<pre><code>##   it clust.i clust.j dist.ij clust.u branch.l.ij
## 1  1       a       b      17      ab         8.5
## 2  2      ab       e      22     abe        11.0
## 3  3       c       d      28      cd        14.0
## 4  4     abe      cd      33   abecd        16.5
## 5  5    &lt;NA&gt;    &lt;NA&gt;      NA    &lt;NA&gt;          NA</code></pre>
<p>The following code adds them to the tree.</p>
<p>First, the brnach lenghts from a to b</p>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="upgma-the-hard-way.html#cb937-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(full.tree, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb937-2"><a href="upgma-the-hard-way.html#cb937-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a-b branch lengths= 8.5</span></span>
<span id="cb937-3"><a href="upgma-the-hard-way.html#cb937-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">5.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb937-4"><a href="upgma-the-hard-way.html#cb937-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">4.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-633-1.png" width="672" /></p>
<p>now a to b, and ab to e</p>
<div class="sourceCode" id="cb938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb938-1"><a href="upgma-the-hard-way.html#cb938-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(full.tree, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb938-2"><a href="upgma-the-hard-way.html#cb938-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a-b branch lengths= 8.5</span></span>
<span id="cb938-3"><a href="upgma-the-hard-way.html#cb938-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">5.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb938-4"><a href="upgma-the-hard-way.html#cb938-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">4.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb938-5"><a href="upgma-the-hard-way.html#cb938-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ab-e branch lengths= 1</span></span>
<span id="cb938-6"><a href="upgma-the-hard-way.html#cb938-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">3.1</span>,<span class="at">labels =</span> <span class="dv">11</span>)</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-634-1.png" width="672" /></p>
<p>There’s a branch between the clade ab and the node that connects with e. What’s its length? FOr a simple ultrametric tree calcualted with UPGMA we can calculate this by subtraction</p>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb939-1"><a href="upgma-the-hard-way.html#cb939-1" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span><span class="fl">-8.5</span></span></code></pre></div>
<pre><code>## [1] 2.5</code></pre>
<p>We’ll added this short branch of 2.5. Note this things ARE NOT to scale.</p>
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb941-1"><a href="upgma-the-hard-way.html#cb941-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(full.tree, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb941-2"><a href="upgma-the-hard-way.html#cb941-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a-b branch lengths= 8.5</span></span>
<span id="cb941-3"><a href="upgma-the-hard-way.html#cb941-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">5.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb941-4"><a href="upgma-the-hard-way.html#cb941-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">4.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb941-5"><a href="upgma-the-hard-way.html#cb941-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ab-e branch lengths= 1</span></span>
<span id="cb941-6"><a href="upgma-the-hard-way.html#cb941-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">3.1</span>,<span class="at">labels =</span> <span class="dv">11</span>)</span>
<span id="cb941-7"><a href="upgma-the-hard-way.html#cb941-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb941-8"><a href="upgma-the-hard-way.html#cb941-8" aria-hidden="true" tabindex="-1"></a><span class="co"># short branch</span></span>
<span id="cb941-9"><a href="upgma-the-hard-way.html#cb941-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">2.5</span>,<span class="at">y =</span> <span class="fl">4.6</span>,<span class="at">labels =</span> <span class="fl">2.5</span>)</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-636-1.png" width="672" /></p>
<p>To visualize exactly what is going on here its useful to add this</p>
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb942-1"><a href="upgma-the-hard-way.html#cb942-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb942-2"><a href="upgma-the-hard-way.html#cb942-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(full.tree, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb942-3"><a href="upgma-the-hard-way.html#cb942-3" aria-hidden="true" tabindex="-1"></a><span class="co"># a-b branch lengths= 8.5</span></span>
<span id="cb942-4"><a href="upgma-the-hard-way.html#cb942-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">4.9</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb942-5"><a href="upgma-the-hard-way.html#cb942-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">4.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb942-6"><a href="upgma-the-hard-way.html#cb942-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ab-e branch lengths= 1</span></span>
<span id="cb942-7"><a href="upgma-the-hard-way.html#cb942-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">3.1</span>,<span class="at">labels =</span> <span class="dv">11</span>)</span>
<span id="cb942-8"><a href="upgma-the-hard-way.html#cb942-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb942-9"><a href="upgma-the-hard-way.html#cb942-9" aria-hidden="true" tabindex="-1"></a><span class="co"># short branch</span></span>
<span id="cb942-10"><a href="upgma-the-hard-way.html#cb942-10" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">2.5</span>,<span class="at">y =</span> <span class="fl">4.6</span>,<span class="at">labels =</span> <span class="fl">2.5</span>)</span>
<span id="cb942-11"><a href="upgma-the-hard-way.html#cb942-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb942-12"><a href="upgma-the-hard-way.html#cb942-12" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0 =</span> <span class="dv">2</span>,<span class="at">x1 =</span> <span class="dv">4</span>,<span class="at">y0 =</span><span class="fl">5.15</span>,<span class="at">y1=</span><span class="fl">5.15</span>, <span class="at">code =</span><span class="dv">3</span>,<span class="at">angle =</span> <span class="dv">90</span>,<span class="at">length =</span><span class="fl">0.1</span>, <span class="at">lty =</span><span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb942-13"><a href="upgma-the-hard-way.html#cb942-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">2.5</span>,<span class="at">y =</span> <span class="dv">5</span>,<span class="at">labels =</span> <span class="st">&quot;2.5+8.5=11&quot;</span>)</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-637-1.png" width="672" /></p>
<p>We can now add the d-e branch of 14 (note again - not to scale!)</p>
<div class="sourceCode" id="cb943"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb943-1"><a href="upgma-the-hard-way.html#cb943-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(full.tree, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb943-2"><a href="upgma-the-hard-way.html#cb943-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a-b branch lengths= 8.5</span></span>
<span id="cb943-3"><a href="upgma-the-hard-way.html#cb943-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">5.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb943-4"><a href="upgma-the-hard-way.html#cb943-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">4.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb943-5"><a href="upgma-the-hard-way.html#cb943-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ab-e branch lengths= 1</span></span>
<span id="cb943-6"><a href="upgma-the-hard-way.html#cb943-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">3.1</span>,<span class="at">labels =</span> <span class="dv">11</span>)</span>
<span id="cb943-7"><a href="upgma-the-hard-way.html#cb943-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb943-8"><a href="upgma-the-hard-way.html#cb943-8" aria-hidden="true" tabindex="-1"></a><span class="co"># short branch</span></span>
<span id="cb943-9"><a href="upgma-the-hard-way.html#cb943-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">2.5</span>,<span class="at">y =</span> <span class="fl">4.6</span>,<span class="at">labels =</span> <span class="fl">2.5</span>)</span>
<span id="cb943-10"><a href="upgma-the-hard-way.html#cb943-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb943-11"><a href="upgma-the-hard-way.html#cb943-11" aria-hidden="true" tabindex="-1"></a><span class="co"># d-e branch</span></span>
<span id="cb943-12"><a href="upgma-the-hard-way.html#cb943-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">1.1</span>,<span class="at">labels =</span> <span class="dv">14</span>)</span>
<span id="cb943-13"><a href="upgma-the-hard-way.html#cb943-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">2.1</span>,<span class="at">labels =</span> <span class="dv">14</span>)</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-638-1.png" width="672" /></p>
<p>The distance from abe to de is 16.5 We can visualize this as</p>
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb944-1"><a href="upgma-the-hard-way.html#cb944-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(full.tree, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb944-2"><a href="upgma-the-hard-way.html#cb944-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a-b branch lengths= 8.5</span></span>
<span id="cb944-3"><a href="upgma-the-hard-way.html#cb944-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">5.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb944-4"><a href="upgma-the-hard-way.html#cb944-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">4.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb944-5"><a href="upgma-the-hard-way.html#cb944-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ab-e branch lengths= 1</span></span>
<span id="cb944-6"><a href="upgma-the-hard-way.html#cb944-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">3.1</span>,<span class="at">labels =</span> <span class="dv">11</span>)</span>
<span id="cb944-7"><a href="upgma-the-hard-way.html#cb944-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb944-8"><a href="upgma-the-hard-way.html#cb944-8" aria-hidden="true" tabindex="-1"></a><span class="co"># short branch</span></span>
<span id="cb944-9"><a href="upgma-the-hard-way.html#cb944-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">2.5</span>,<span class="at">y =</span> <span class="fl">4.6</span>,<span class="at">labels =</span> <span class="fl">2.5</span>)</span>
<span id="cb944-10"><a href="upgma-the-hard-way.html#cb944-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb944-11"><a href="upgma-the-hard-way.html#cb944-11" aria-hidden="true" tabindex="-1"></a><span class="co"># d-e branch</span></span>
<span id="cb944-12"><a href="upgma-the-hard-way.html#cb944-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">1.1</span>,<span class="at">labels =</span> <span class="dv">14</span>)</span>
<span id="cb944-13"><a href="upgma-the-hard-way.html#cb944-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">2.1</span>,<span class="at">labels =</span> <span class="dv">14</span>)</span>
<span id="cb944-14"><a href="upgma-the-hard-way.html#cb944-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb944-15"><a href="upgma-the-hard-way.html#cb944-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb944-16"><a href="upgma-the-hard-way.html#cb944-16" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0 =</span> <span class="dv">0</span>,<span class="at">x1 =</span> <span class="dv">4</span>,<span class="at">y0 =</span><span class="fl">0.85</span>,<span class="at">y1=</span><span class="fl">0.85</span>, <span class="at">code =</span><span class="dv">3</span>,<span class="at">angle =</span> <span class="dv">90</span>,<span class="at">length =</span><span class="fl">0.1</span>, <span class="at">lty =</span><span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb944-17"><a href="upgma-the-hard-way.html#cb944-17" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span>,<span class="at">y =</span> <span class="dv">1</span>,<span class="at">labels =</span> <span class="fl">16.5</span>)</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-639-1.png" width="672" /></p>
<p>We can calcualte the distance of the remaining short branch from de to the root as 16.5-14 = 2.5. When we plot this again, it won’t be to scale</p>
<div class="sourceCode" id="cb945"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb945-1"><a href="upgma-the-hard-way.html#cb945-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(full.tree, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb945-2"><a href="upgma-the-hard-way.html#cb945-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a-b branch lengths= 8.5</span></span>
<span id="cb945-3"><a href="upgma-the-hard-way.html#cb945-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">5.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb945-4"><a href="upgma-the-hard-way.html#cb945-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">4.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb945-5"><a href="upgma-the-hard-way.html#cb945-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ab-e branch lengths= 1</span></span>
<span id="cb945-6"><a href="upgma-the-hard-way.html#cb945-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">3.1</span>,<span class="at">labels =</span> <span class="dv">11</span>)</span>
<span id="cb945-7"><a href="upgma-the-hard-way.html#cb945-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb945-8"><a href="upgma-the-hard-way.html#cb945-8" aria-hidden="true" tabindex="-1"></a><span class="co"># short branch</span></span>
<span id="cb945-9"><a href="upgma-the-hard-way.html#cb945-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">2.5</span>,<span class="at">y =</span> <span class="fl">4.6</span>,<span class="at">labels =</span> <span class="fl">2.5</span>)</span>
<span id="cb945-10"><a href="upgma-the-hard-way.html#cb945-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb945-11"><a href="upgma-the-hard-way.html#cb945-11" aria-hidden="true" tabindex="-1"></a><span class="co"># d-e branch</span></span>
<span id="cb945-12"><a href="upgma-the-hard-way.html#cb945-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">1.1</span>,<span class="at">labels =</span> <span class="dv">14</span>)</span>
<span id="cb945-13"><a href="upgma-the-hard-way.html#cb945-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">2.1</span>,<span class="at">labels =</span> <span class="dv">14</span>)</span>
<span id="cb945-14"><a href="upgma-the-hard-way.html#cb945-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb945-15"><a href="upgma-the-hard-way.html#cb945-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb945-16"><a href="upgma-the-hard-way.html#cb945-16" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0 =</span> <span class="dv">0</span>,<span class="at">x1 =</span> <span class="dv">4</span>,<span class="at">y0 =</span><span class="fl">0.85</span>,<span class="at">y1=</span><span class="fl">0.85</span>, <span class="at">code =</span><span class="dv">3</span>,<span class="at">angle =</span> <span class="dv">90</span>,<span class="at">length =</span><span class="fl">0.1</span>, <span class="at">lty =</span><span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb945-17"><a href="upgma-the-hard-way.html#cb945-17" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span>,<span class="at">y =</span> <span class="dv">1</span>,<span class="at">labels =</span> <span class="st">&quot;16.5 - 14 = 2.5&quot;</span>)</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-640-1.png" width="672" /></p>
<p>We can calculate the remaining short branch from abe to the root as
16.5-8.5-2.5
=16.5-11
=5.5</p>
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb946-1"><a href="upgma-the-hard-way.html#cb946-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(full.tree, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb946-2"><a href="upgma-the-hard-way.html#cb946-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a-b branch lengths= 8.5</span></span>
<span id="cb946-3"><a href="upgma-the-hard-way.html#cb946-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">5.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb946-4"><a href="upgma-the-hard-way.html#cb946-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">4.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb946-5"><a href="upgma-the-hard-way.html#cb946-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ab-e branch lengths= 1</span></span>
<span id="cb946-6"><a href="upgma-the-hard-way.html#cb946-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">3.1</span>,<span class="at">labels =</span> <span class="dv">11</span>)</span>
<span id="cb946-7"><a href="upgma-the-hard-way.html#cb946-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb946-8"><a href="upgma-the-hard-way.html#cb946-8" aria-hidden="true" tabindex="-1"></a><span class="co"># short branch</span></span>
<span id="cb946-9"><a href="upgma-the-hard-way.html#cb946-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">2.5</span>,<span class="at">y =</span> <span class="fl">4.6</span>,<span class="at">labels =</span> <span class="fl">2.5</span>)</span>
<span id="cb946-10"><a href="upgma-the-hard-way.html#cb946-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb946-11"><a href="upgma-the-hard-way.html#cb946-11" aria-hidden="true" tabindex="-1"></a><span class="co"># d-e branch</span></span>
<span id="cb946-12"><a href="upgma-the-hard-way.html#cb946-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">1.1</span>,<span class="at">labels =</span> <span class="dv">14</span>)</span>
<span id="cb946-13"><a href="upgma-the-hard-way.html#cb946-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">2.1</span>,<span class="at">labels =</span> <span class="dv">14</span>)</span>
<span id="cb946-14"><a href="upgma-the-hard-way.html#cb946-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb946-15"><a href="upgma-the-hard-way.html#cb946-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb946-16"><a href="upgma-the-hard-way.html#cb946-16" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0 =</span> <span class="dv">0</span>,<span class="at">x1 =</span> <span class="dv">4</span>,<span class="at">y0 =</span><span class="fl">0.85</span>,<span class="at">y1=</span><span class="fl">0.85</span>, <span class="at">code =</span><span class="dv">3</span>,<span class="at">angle =</span> <span class="dv">90</span>,<span class="at">length =</span><span class="fl">0.1</span>, <span class="at">lty =</span><span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb946-17"><a href="upgma-the-hard-way.html#cb946-17" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span>,<span class="at">y =</span> <span class="dv">1</span>,<span class="at">labels =</span> <span class="st">&quot;16.5 - 14 = 2.5&quot;</span>)</span>
<span id="cb946-18"><a href="upgma-the-hard-way.html#cb946-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb946-19"><a href="upgma-the-hard-way.html#cb946-19" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0 =</span> <span class="dv">0</span>,<span class="at">x1 =</span> <span class="dv">4</span>,<span class="at">y0 =</span><span class="fl">5.1</span>,<span class="at">y1=</span><span class="fl">5.1</span>, <span class="at">code =</span><span class="dv">3</span>,<span class="at">angle =</span> <span class="dv">90</span>,<span class="at">length =</span><span class="fl">0.1</span>, <span class="at">lty =</span><span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb946-20"><a href="upgma-the-hard-way.html#cb946-20" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span>,<span class="at">y =</span> <span class="dv">5</span>,<span class="at">labels =</span> <span class="st">&quot;16.5 - 8.5 - 2.5 = 5.5&quot;</span>)</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-641-1.png" width="672" /></p>
<p>So the final tree has branch lengths (not to scale!) of</p>
<div class="sourceCode" id="cb947"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb947-1"><a href="upgma-the-hard-way.html#cb947-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(full.tree, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb947-2"><a href="upgma-the-hard-way.html#cb947-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a-b branch lengths= 8.5</span></span>
<span id="cb947-3"><a href="upgma-the-hard-way.html#cb947-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">5.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb947-4"><a href="upgma-the-hard-way.html#cb947-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">4.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb947-5"><a href="upgma-the-hard-way.html#cb947-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ab-e branch lengths= 1</span></span>
<span id="cb947-6"><a href="upgma-the-hard-way.html#cb947-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">3.1</span>,<span class="at">labels =</span> <span class="dv">11</span>)</span>
<span id="cb947-7"><a href="upgma-the-hard-way.html#cb947-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb947-8"><a href="upgma-the-hard-way.html#cb947-8" aria-hidden="true" tabindex="-1"></a><span class="co"># short branch</span></span>
<span id="cb947-9"><a href="upgma-the-hard-way.html#cb947-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">2.5</span>,<span class="at">y =</span> <span class="fl">4.6</span>,<span class="at">labels =</span> <span class="fl">2.5</span>)</span>
<span id="cb947-10"><a href="upgma-the-hard-way.html#cb947-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb947-11"><a href="upgma-the-hard-way.html#cb947-11" aria-hidden="true" tabindex="-1"></a><span class="co"># d-e branch</span></span>
<span id="cb947-12"><a href="upgma-the-hard-way.html#cb947-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">1.1</span>,<span class="at">labels =</span> <span class="dv">14</span>)</span>
<span id="cb947-13"><a href="upgma-the-hard-way.html#cb947-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.5</span>,<span class="at">y =</span> <span class="fl">2.1</span>,<span class="at">labels =</span> <span class="dv">14</span>)</span>
<span id="cb947-14"><a href="upgma-the-hard-way.html#cb947-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb947-15"><a href="upgma-the-hard-way.html#cb947-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb947-16"><a href="upgma-the-hard-way.html#cb947-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb947-17"><a href="upgma-the-hard-way.html#cb947-17" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span>,<span class="at">y =</span> <span class="fl">1.6</span>,<span class="at">labels =</span> <span class="st">&quot;2.5&quot;</span>)</span>
<span id="cb947-18"><a href="upgma-the-hard-way.html#cb947-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb947-19"><a href="upgma-the-hard-way.html#cb947-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb947-20"><a href="upgma-the-hard-way.html#cb947-20" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span>,<span class="at">y =</span> <span class="dv">4</span>,<span class="at">labels =</span> <span class="st">&quot;5.5&quot;</span>)</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-642-1.png" width="672" /></p>
<p>Most of the time we don’t include branch lengths in Newick format, but there is a way to do it. You don’t need to know how to do this - this is just for illustration</p>
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb948-1"><a href="upgma-the-hard-way.html#cb948-1" aria-hidden="true" tabindex="-1"></a>full.tree <span class="ot">&lt;-</span> <span class="st">&quot;((c:14,d:14):2.5,(e:11,(b:8.5, a:8.5):2.5):5.5);&quot;</span> <span class="co"># semi colon!</span></span>
<span id="cb948-2"><a href="upgma-the-hard-way.html#cb948-2" aria-hidden="true" tabindex="-1"></a>full.tree <span class="ot">&lt;-</span><span class="fu">read.tree</span>(<span class="at">text=</span>full.tree)</span>
<span id="cb948-3"><a href="upgma-the-hard-way.html#cb948-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(full.tree, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb948-4"><a href="upgma-the-hard-way.html#cb948-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb948-5"><a href="upgma-the-hard-way.html#cb948-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">10</span>,<span class="at">y =</span> <span class="fl">5.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb948-6"><a href="upgma-the-hard-way.html#cb948-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">10</span>,<span class="at">y =</span> <span class="fl">4.1</span>,<span class="at">labels =</span> <span class="fl">8.5</span>)</span>
<span id="cb948-7"><a href="upgma-the-hard-way.html#cb948-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ab-e branch lengths= 1</span></span>
<span id="cb948-8"><a href="upgma-the-hard-way.html#cb948-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">10</span>,<span class="at">y =</span> <span class="fl">3.1</span>,<span class="at">labels =</span> <span class="dv">11</span>)</span>
<span id="cb948-9"><a href="upgma-the-hard-way.html#cb948-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb948-10"><a href="upgma-the-hard-way.html#cb948-10" aria-hidden="true" tabindex="-1"></a><span class="co"># short branch</span></span>
<span id="cb948-11"><a href="upgma-the-hard-way.html#cb948-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">7</span>,<span class="at">y =</span> <span class="fl">4.6</span>,<span class="at">labels =</span> <span class="fl">2.5</span>)</span>
<span id="cb948-12"><a href="upgma-the-hard-way.html#cb948-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb948-13"><a href="upgma-the-hard-way.html#cb948-13" aria-hidden="true" tabindex="-1"></a><span class="co"># d-e branch</span></span>
<span id="cb948-14"><a href="upgma-the-hard-way.html#cb948-14" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">10</span>,<span class="at">y =</span> <span class="fl">1.1</span>,<span class="at">labels =</span> <span class="dv">14</span>)</span>
<span id="cb948-15"><a href="upgma-the-hard-way.html#cb948-15" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">10</span>,<span class="at">y =</span> <span class="fl">2.1</span>,<span class="at">labels =</span> <span class="dv">14</span>)</span>
<span id="cb948-16"><a href="upgma-the-hard-way.html#cb948-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb948-17"><a href="upgma-the-hard-way.html#cb948-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb948-18"><a href="upgma-the-hard-way.html#cb948-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb948-19"><a href="upgma-the-hard-way.html#cb948-19" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">1.5</span>,<span class="at">y =</span> <span class="fl">1.6</span>,<span class="at">labels =</span> <span class="st">&quot;2.5&quot;</span>)</span>
<span id="cb948-20"><a href="upgma-the-hard-way.html#cb948-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb948-21"><a href="upgma-the-hard-way.html#cb948-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb948-22"><a href="upgma-the-hard-way.html#cb948-22" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">1.5</span>,<span class="at">y =</span> <span class="fl">3.9</span>,<span class="at">labels =</span> <span class="st">&quot;5.5&quot;</span>)</span></code></pre></div>
<p><img src="lbrb_files/figure-html/unnamed-chunk-643-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="calculating-e-values-bit-scores-and-p-values-from-blast-output.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="representing-phylogenetic-trees-in-newick-format.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/brouwern/lbrb/edit/master/tree-think_UPGMA_wikidat_compare_to_ordination_calcs_by_hand-UPDATED.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/brouwern/lbrb/blob/master/tree-think_UPGMA_wikidat_compare_to_ordination_calcs_by_hand-UPDATED.Rmd",
"text": null
},
"download": ["lbrb.pdf", "lbrb.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
